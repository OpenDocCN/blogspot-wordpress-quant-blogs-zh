["```\n#explore dividend data from the\n#very helpful Ken French\n#for this project we will look at Dividend Portfolios\n#http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/ftp/Portfolios_Formed_on_D-P.zip   require(PerformanceAnalytics)\nrequire(quantmod)\nrequire(ggplot2)   my.url=\"http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/ftp/Portfolios_Formed_on_D-P.zip\"\nmy.tempfile<-paste(tempdir(),\"\\\\frenchmomentum.zip\",sep=\"\")\nmy.usefile<-paste(tempdir(),\"\\\\Portfolios_Formed_on_D-P.txt\",sep=\"\")\ndownload.file(my.url, my.tempfile, method=\"auto\", \n\tquiet = FALSE, mode = \"wb\",cacheOK = TRUE)\nunzip(my.tempfile,exdir=tempdir(),junkpath=TRUE)\n#read space delimited text file extracted from zip\nfrench_dividend <- read.table(file=my.usefile,\n\theader = FALSE, sep = \"\",\n\tas.is = TRUE,\n\tskip = 20, nrows=1002)[,1:5]\ncolnames(french_dividend) <- c(\"date\",\"Zero\",\"Low\",\"Mid\",\"High\")   #get dates ready for xts index\ndatestoformat <- french_dividend[,1]\ndatestoformat <- paste(substr(datestoformat,1,4),\n\tsubstr(datestoformat,5,7),\"01\",sep=\"-\")   #get xts for analysis\nfrench_dividend_xts <- as.xts(french_dividend[,2:5],\n\torder.by=as.Date(datestoformat))   french_dividend_xts <- french_dividend_xts/100   #jpeg(filename=\"performance summary of dividend portfolios.jpg\",\n#\tquality=100,width=6.25, height = 8,  units=\"in\",res=96)\ncharts.PerformanceSummary(french_dividend_xts,ylog=TRUE,cex.legend=1.25,\n\tmain=\"Performance by Kenneth French Dividend\n\tMonthly Since 1927\",\n\tcolorset=c(\"cadetblue3\",\"cadetblue\",\"cadetblue4\",\n\t\"darkolivegreen3\",\"darkolivegreen\",\"darkolivegreen4\"))\nmtext(\"Source: http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html\",\n\tside=1,adj=0,cex=0.75)\n#dev.off()   #get price series of small cap high momentum for system building\n#by applying the cumprod function on each column\nfrench_dividend_price <- as.xts(apply(french_dividend_xts[,1:4]+1,FUN=\"cumprod\",MARGIN=2))\n#if we wanted to compare to the average of all we could use this\n#french_all_price <- cumprod(1+apply(coredata(french_dividend_xts[,c(1:4)]),MARGIN=1,FUN=mean))   #jpeg(filename=\"linear models of relative strength dividend.jpg\",\n#\tquality=100,width=6.25, height = 8,  units=\"in\",res=96)\npar(mfrow=c(3,1))\nfor (i in 1:3) {\n\tfrench_rs <- log(french_dividend_price[,4]/french_dividend_price[,i])\n\tmodel <- lm(french_rs[,1]~index(french_rs))\n\tplot(french_rs,type=\"l\",\n\t\tmain=paste(\"French High Dividend to \",colnames(french_dividend_xts)[i],\" Dividend\",sep=\"\"))\n\tabline(lm(french_rs~index(french_rs)))\n}\nmtext(\"Source: http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html\",\n\tside=1,adj=0,cex=0.75)\n#dev.off()   #jpeg(filename=\"linear residuals of relative strength dividend.jpg\",\n#\tquality=100,width=6.25, height = 8,  units=\"in\",res=96)\npar(mfrow=c(3,1))\nfor (i in 1:3) {\n\tfrench_rs <- log(french_dividend_price[,4]/french_dividend_price[,i])\n\tmodel <- lm(french_rs[,1]~index(french_rs))\n\tplot(runSum(as.xts(model$residuals[,1]),n=24),type=\"l\",\n\t\tmain=paste(\"Residuals French High Dividend to \",colnames(french_dividend_xts)[i],\" Dividend\",sep=\"\"))\n}\nmtext(\"Source: http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html\",\n\tside=1,adj=0,cex=0.75)\n#dev.off()\n#another way to chart\n#\tchartSeries(french_rs,theme=\"white\") ,\n#\t\tTA=\"addTA(as.xts(model$fitted.values[,1]),on=1)\");addTA(runSum(as.xts(model$residuals[,1]),n=24))\")             #######################################################\n#for later possibly\n#apply earlier charts and systems from momentum to the dividend data   #speedy solution for ranking from Charles Berry\n# http://r.789695.n4.nabble.com/efficient-rolling-rank-td2013535.html\n#rolling rank of price over last 12 months (12 means max price for last 12)\n#pad first 11 with NA\nnper <- 10\nx.rank <- c(rep(NA,nper-1),rowSums(coredata(french_high_price)[ -(1:(nper-1)) ] >= embed(french_high_price,nper)))\nx.rank <- as.xts(x.rank,order.by=index(french_high_price))\nsignalRank <- ifelse(x.rank[,1] > 3 | \n\tfrench_high_price >= runMax(french_high_price,2),1,0)\nretRank <- lag(signalRank,k=1)*french_dividend_xts[,4]   #try rolling 10 month moving average popularized by Mebane Faber\nsignalAvg <- ifelse(french_high_price > runMean(french_high_price,n=10),1,0)\nretAvg <- lag(signalAvg,k=1)*french_dividend_xts[,4]   #try RSI\nsignalRSI <- ifelse(RSI(french_high_price,n=4) > 45,1,0)\nretRSI <- lag(signalRSI,k=1)*french_dividend_xts[,4]   retCompare <- merge(retRank,retAvg,retRSI,french_dividend_xts[,4])\ncolnames(retCompare) <- c(\"Small.High.Rank\",\n\t\"Small.High.Avg\",\"Small.High.RSI\",\"Small.High.Benchmark\")\n#jpeg(filename=\"performance of small-high with systems.jpg\",quality=100,width=6.25, height = 8,  units=\"in\",res=96)\ncharts.PerformanceSummary(retCompare,ylog=TRUE,cex.legend=1.2,\n\tcolorset = c(\"cadetblue\",\"darkolivegreen3\",\"purple\",\"gray70\"),\n\tmain=\"Kenneth French Small Size and High Momentum Stocks\n\tCompared To Various Price Systems\")\n#dev.off()   #jpeg(filename=\"capture of small-high with systems.jpg\",quality=100,width=6.25, height = 8,  units=\"in\",res=96)\nchart.CaptureRatios(retCompare[,1:3],retCompare[,4],\n\tmain=\"Kenneth French Small Size and High Momentum Stocks\n\tCompared To Various Price Systems\")\n#dev.off()   #get average of small size for additional system testing\nfrench_dividend_avg <- cumprod(1+apply(coredata(french_dividend_xts[,c(1:4)]),MARGIN=1,FUN=mean))\nfrench_dividend_avg <- as.xts(french_dividend_avg,order.by=index(french_high_price))\nnper <- 10\nx.rank <- c(rep(NA,nper-1),rowSums(coredata(french_dividend_avg)[ -(1:(nper-1)) ] >= embed(french_dividend_avg,nper)))\nx.rank <- as.xts(x.rank,order.by=index(french_dividend_avg))\nsignalRankAvg <- ifelse(x.rank[,1] > 3 | \n\tfrench_dividend_avg >= runMax(french_dividend_avg,2),1,0)\nretRankAvg <- lag(signalRankAvg,k=1)*french_dividend_xts[,4]   retCompare <- merge(retRank,retRankAvg,french_dividend_xts[,3])\ncolnames(retCompare) <- c(\"Small.High.Rank\",\n\t\"Small.High.RankOnAvg\",\"Small.High.Benchmark\")\n#jpeg(filename=\"performance of small-high with 2 rank systems.jpg\",quality=100,width=6.25, height = 8,  units=\"in\",res=96)\ncharts.PerformanceSummary(retCompare,ylog=TRUE,cex.legend=1.2,\n\tcolorset = c(\"cadetblue\",\"darkolivegreen3\",\"gray70\"),\n\tmain=\"Kenneth French Small Size and High Momentum Stocks\n\tCompared To Rank-based Price Systems\")\n#dev.off()       chart.QQPlot(french_dividend_xts[,4],\n\t main = \"Normal Distribution\", distribution = 'norm', envelope=0.95)\nlibrary(MASS)\nfit = fitdistr(1+french_dividend_xts[,3], 'lognormal')\nchart.QQPlot(1+french_dividend_xts[,3], main = \"Log-Normal Distribution\", envelope=0.95, distribution='lnorm', meanlog = fit$estimate[[1]], sdlog = fit$estimate[[2]])\nlibrary(sn)\nfit = st.mle(y=french_dividend_xts[,3])\nchart.QQPlot(french_dividend_xts[,3], main = \"Skew T Distribution\", envelope=0.95, distribution = 'st', location = fit$dp[[1]], scale = fit$dp[[2]], shape = fit$dp[[3]], df=fit$dp[[4]])       chart.Histogram(french_dividend_xts[,4], methods = c( \"add.density\", \"add.normal\") )\nchart.Histogram(french_dividend_xts[,1], methods = c( \"add.centered\", \"add.density\", \"add.rug\") )\nchart.Histogram(french_dividend_xts[,3], methods = c( \"add.centered\", \"add.density\", \"add.rug\", \"add.qqplot\") )\nchart.Histogram(french_dividend_xts[,3], methods = c(\"add.density\", \"add.centered\", \"add.rug\", \"add.risk\") )     #interesting linearity between momentum\nchart.Regression(french_dividend_xts[,4], apply(coredata(french_dividend_xts[,c(1:4)]),MARGIN=1,FUN=mean),\n\t fit=\"conditional\", main=\"Conditional Beta\")\n```"]