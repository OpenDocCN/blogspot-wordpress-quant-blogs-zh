["```\n#extends post on principal component analysis with MODist\n#using example from http://www.rinfinance.com/agenda/2011/StefanoIacus.pdf\n#on currency data and fidelity mutual fund data   require(quantmod)   #get currency data from the FED FRED data series\nKorea  <-  getSymbols(\"DEXKOUS\",src=\"FRED\",auto.assign=FALSE) #load Korea\nMalaysia  <-  getSymbols(\"DEXMAUS\",src=\"FRED\",auto.assign=FALSE) #load Malaysia\nSingapore  <-  getSymbols(\"DEXSIUS\",src=\"FRED\",auto.assign=FALSE) #load Singapore\nTaiwan  <-  getSymbols(\"DEXTAUS\",src=\"FRED\",auto.assign=FALSE) #load Taiwan\nChina  <-  getSymbols(\"DEXCHUS\",src=\"FRED\",auto.assign=FALSE) #load China\nJapan  <-  getSymbols(\"DEXJPUS\",src=\"FRED\",auto.assign=FALSE) #load Japan\nThailand  <-  getSymbols(\"DEXTHUS\",src=\"FRED\",auto.assign=FALSE) #load Thailand\nBrazil  <-  getSymbols(\"DEXBZUS\",src=\"FRED\",auto.assign=FALSE) #load Brazil\nMexico  <-  getSymbols(\"DEXMXUS\",src=\"FRED\",auto.assign=FALSE) #load Mexico\nIndia  <-  getSymbols(\"DEXINUS\",src=\"FRED\",auto.assign=FALSE) #load India\nUSDOther  <-  getSymbols(\"DTWEXO\",src=\"FRED\",auto.assign=FALSE) #load US Dollar Other Trading Partners\nUSDBroad  <-  getSymbols(\"DTWEXB\",src=\"FRED\",auto.assign=FALSE) #load US Dollar Broad       #combine all the currencies into one big currency xts\ncurrencies <- merge(Korea, Malaysia, Singapore, Taiwan,\n\tChina, Japan, Thailand, Brazil, Mexico, India,\n\tUSDOther, USDBroad)\ncurrencies <- na.omit(currencies)\ncolnames(currencies) <- c(\"Korea\", \"Malaysia\", \"Singapore\", \"Taiwan\",\n\t\"China\", \"Japan\", \"Thailand\", \"Brazil\", \"Mexico\", \"India\",\n\t\"USDOther\", \"USDBroad\")       #use MODist package as described in the fine presentation\n#http://www.rinfinance.com/agenda/2011/StefanoIacus.pdf\nrequire(sde)   currencies <- as.zoo(currencies)\nd  <-  MOdist(currencies)\ncl  <-  hclust( d )\ngroups  <-  cutree(cl, k=4)\nplot(currencies, col=groups, main=\"Various Asian and American Currencies\n\t1995-Current\")\ncmd  <-  cmdscale(d)\ncolnames(cmd)  <-  c(\"first coordinate\",\"second coordinate\")\nplot( cmd, col=groups, main=\"MODist of Various Asian and American Currencies\n\t1995-Current\" )\ntext( cmd, labels(d) , col=groups)   #struggling with whether price or percent change works better\n#run again with percentage change\ncurrencies <- ROC(currencies,1,type=\"discrete\")\ncurrencies[1,1:NCOL(currencies)] <- 0\ncurrencies <- as.zoo(currencies)\nd  <-  MOdist(currencies)\ncl  <-  hclust( d )\ngroups  <-  cutree(cl, k=4)\ncmd  <-  cmdscale(d)\ncolnames(cmd)  <-  c(\"first coordinate\",\"second coordinate\")\nplot( cmd, col=groups, main=\"MODist of Various Asian and American Currencies\n\tPercentage Change 1995-Current\" )\ntext( cmd, labels(d) , col=groups)     #do the same MODist for some Fidelity Funds\n#except just use price change rather than price\ntckr<-c(\"FBGRX\",\"FCNTX\",\"FDGFX\",\"FEQIX\",\"FEXPX\",\n\t\"FFTYX\",\"FFIDX\",\"FDGRX\",\"FDEGX\",\"FLCSX\",\n\t\"FMCSX\",\"FOCPX\",\"FDVLX\",\"FSLSX\",\"FIVFX\",\n\t\"FOSFX\",\"FRESX\",\"FSEMX\",\"FSTMX\",\"FPURX\")\nstart<-\"1990-01-01\"\nend<- format(Sys.Date(),\"%Y-%m-%d\") # yyyy-mm-dd   # Pull tckr index data from Yahoo! Finance\ngetSymbols(tckr, from=start, to=end, adjust=TRUE)   fidelity<-na.omit(merge(to.weekly(FBGRX)[,4],to.weekly(FCNTX)[,4],\n\tto.weekly(FDGFX)[,4] ,to.weekly(FEQIX)[,4],\n\tto.weekly(FEXPX)[,4] , to.weekly(FFTYX)[,4],\n\tto.weekly(FFIDX)[,4] , to.weekly(FDGRX)[,4],\n\tto.weekly(FDEGX)[,4] , to.weekly(FLCSX)[,4],\n\tto.weekly(FMCSX)[,4] , to.weekly(FOCPX)[,4],\n\tto.weekly(FDVLX)[,4] , to.weekly(FSLSX)[,4],\t\n\tto.weekly(FIVFX)[,4] , to.weekly(FOSFX)[,4],\n\tto.weekly(FRESX)[,4] , to.weekly(FSEMX)[,4],\n\tto.weekly(FSTMX)[,4] , to.weekly(FPURX)[,4]))   colnames(fidelity) <- substr(colnames(fidelity),1,5)   fidelity <- ROC(fidelity,1,type=\"discrete\")\nfidelity[1,1:NCOL(fidelity)] <- 0\nfidelity <- as.zoo(fidelity)   d  <-  MOdist(fidelity)\ncl  <-  hclust( d )\ngroups  <-  cutree(cl, k=5)\nplot(fidelity, col=groups, main=\"Various Fidelity Mutual Funds\n\t1998-Current\")\ncmd  <-  cmdscale(d)\ncolnames(cmd)  <-  c(\"first coordinate\",\"second coordinate\")\nplot( cmd, col=groups, main=\"MODist of Various Fidelity Mutual Funds\n\t1995-Current\" )\ntext( cmd, labels(d) , col=groups)   #get plot of eigenvalues since we have not done in any\n#previous posts\n#using techniques from corrgram package documentation\n#get correlation matrix\n(fidelity.cor <- cor(fidelity,use=\"pair\"))\n#get two largest eigenvectors\n(fidelity.eig <- eigen(fidelity.cor)$vectors[,1:2])\ne1 <- fidelity.eig[,1]\ne2 <- fidelity.eig[,2]\n#make the chart\nplot(e1,e2,col='white', xlim=range(e1,e2), ylim=range(e1,e2),\n\tmain=\"Plot of 2 Largest Eigenvectors for Various Fidelity Funds\")\narrows(0, 0, e1, e2, cex=0.5, col=groups, length=0.1)\ntext(e1,e2, rownames(fidelity.cor), cex=0.75, col=groups)\n```"]