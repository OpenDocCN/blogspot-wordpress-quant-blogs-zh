["```\nrequire(quantmod)\nrequire(PerformanceAnalytics)   getSymbols(\"^RUT\",from=\"1919-01-01\",to=Sys.Date())   RUT <- to.monthly(RUT)[,4]\nindex(RUT) <- as.Date(index(RUT))   #get 10 month rolling average\navg10 <- runMean(RUT,n=10)   #know I can do this better in R but here is my ugly code\n#to calculate 6 month slope of 10 month average\nwidth=6\nfor (i in 1:(NROW(avg10)-width)) {\t\n\t#get sp500/crb slope\n\tmodel <- lm(RUT[i:(i+width),1]~index(RUT[i:(i+width)]))\n\tifelse(i==1,avg10slope <- model$coefficients[2],\n\t\tavg10slope <- rbind(avg10slope,model$coefficients[2]))\n}\n#get xts so we can use\navg10slope <- xts(cbind(avg10slope),order.by=index(avg10)[(width+1):NROW(avg10)])   priceSignals <- na.omit(merge(RUT,avg10,avg10slope))   signalUpUp <- ifelse(priceSignals[,1] > priceSignals[,2] & priceSignals[,3] > 0, 1, 0)\nsignalUpDown <- ifelse(priceSignals[,1] > priceSignals[,2] & priceSignals[,3] < 0, 1, 0)\nsignalDownUp <- ifelse(priceSignals[,1] < priceSignals[,2] & priceSignals[,3] > 0, 1, 0)\nsignalDownDown <- ifelse(priceSignals[,1] < priceSignals[,2] & priceSignals[,3] < 0, 1, 0)   retUpUp <- lag(signalUpUp,k=1)* ROC(RUT,type=\"discrete\",n=1)\nretUpDown <- lag(signalUpDown,k=1)* ROC(RUT,type=\"discrete\",n=1)\nretDownUp <- lag(signalDownUp, k=1) * ROC(RUT,type=\"discrete\",n=1)\nretDownDown <- lag(signalDownDown, k=1) * ROC(RUT,type=\"discrete\",n=1)   ret <- merge(retUpUp,retUpDown,retDownUp,retDownDown,ROC(RUT,type=\"discrete\",n=1))\ncolnames(ret) <- c(\"UpUp\",\"UpDown\",\"DownUp\",\"DownDown\",\"RUT\")   jpeg(filename=\"performance summary.jpg\",quality=100,\n\twidth=6.25, height = 6.25,  units=\"in\",res=96)\ncharts.PerformanceSummary(ret,ylog=TRUE,\n\tcolorset=c(\"cadetblue\",\"darkolivegreen3\",\"goldenrod\",\"purple\",\"gray70\",\"black\"),\n\tmain=\"RUT 10 Month Moving Average Strategy Comparisons\n\tMay 1987-Jun 2011\")\ndev.off()   jpeg(filename=\"rolling returns.jpg\",quality=100,\n\twidth=6.25, height = 6.25,  units=\"in\",res=96)\nchart.RollingPerformance(ret,width=36,\n\tcolorset=c(\"cadetblue\",\"darkolivegreen3\",\"goldenrod\",\"purple\",\"gray70\",\"black\"),\n\tmain=\"RUT 10 Month Moving Average Strategy Comparisons\n\t36 Month Rolling Return May 1987-Jun 2011\")\ndev.off()\n```"]