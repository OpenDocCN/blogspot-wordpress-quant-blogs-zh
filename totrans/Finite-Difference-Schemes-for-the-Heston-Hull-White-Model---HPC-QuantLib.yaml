- en: <!--yml
  prefs: []
  type: TYPE_NORMAL
- en: 'category: 未分类'
  prefs: []
  type: TYPE_NORMAL
- en: 'date: 2024-05-17 23:39:21'
  prefs: []
  type: TYPE_NORMAL
- en: -->
  prefs: []
  type: TYPE_NORMAL
- en: Finite Difference Schemes for the Heston-Hull-White Model – HPC-QuantLib
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 来源：[https://hpcquantlib.wordpress.com/2011/09/11/finite-difference-schemes-for-the-heston-hull-white-model/#0001-01-01](https://hpcquantlib.wordpress.com/2011/09/11/finite-difference-schemes-for-the-heston-hull-white-model/#0001-01-01)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: The hybrid Heston-Hull-White model is tailor-made to analyse the impact of stochastic
    interest rates on structured equity notes like e.g. auto-callables.
  prefs: []
  type: TYPE_NORMAL
- en: '![\begin{array}{rcl} dS_t &=& (r_t-q_t) S_t dt + \sqrt{v_t} S_t dW_t^S \\ dv_t
    &=& \kappa_v (\theta_v - v_t) dt + \sigma_v \sqrt{v_t} dW_t^v \\ dr_t & = & \kappa_r(\theta_{r,t}-r_t)
    dt + \sigma_r dW_t^r \\ \rho_{Sv} dt &=& dW_t^S dW_t^v\\ \rho_{Sr} dt &=& dW_t^S
    dW_t^r \\ \rho_{vr} dt &=& dW_t^v dW_t^r \end{array}](img/2c5753d66230142f97a062adcc851613.png)'
  prefs: []
  type: TYPE_IMG
- en: Unfortunately a semi-closed solution for european options exists only if at
    least two correlations are equal to zero which is in general unrealistic. A set
    of semi-closed approximations for this model can be found [here](http://mpra.ub.uni-muenchen.de/24174/1/MPRA_paper_24174.pdf)
    [1]. The [QuantLib](http://www.quantlib.org) has a finite difference pricing engine
    for american, bermudan and european options for the Heston-Hull-White model. This
    pricing engine supports cash dividends, control variate via the semi-closed Heston
    Model and pricing different strikes of european options of the same maturity using
    one backward solver run (especially useful to gain a large speed-up during model
    calibration.).
  prefs: []
  type: TYPE_NORMAL
- en: 'The Heston-Hull-White model is a good testbed to test the efficiency of the
    finite difference schemes based on operator splitting which are implemented in
    the [QuantLib](http://www.quantlib.org) :'
  prefs: []
  type: TYPE_NORMAL
- en: Douglas
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Craig-Sneyd
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Modified Craig-Sneyd
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hundsdorfer-Verwer
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Modified Hundsdorfer-Verwer
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: These operator splitting methods are described [here](http://www.math.ualberta.ca/ijnam/Volume-7-2010/No-2-10/2010-02-06.pdf)
    [2]. The testbed contains ten parameter sets of the Heston-Model taken from different
    publications.
  prefs: []
  type: TYPE_NORMAL
- en: '![\begin{array}{|c|c|c|c|c|c|c|c|c|} \hline {\rm Model} & v_0 & \kappa_v &
    \theta_v & \sigma_v & \rho_{Sv} & r & q & \mbox{Ref} \\ \hline \hline {\rm''t\
    Hout\ Case\ 1}& 0.04& 1.5& 0.04& 0.3& -0.9& 0.025& 0.0 &[2]\\ {\rm''t\ Hout\ Case\
    2} & 0.12& 3.0& 0.12& 0.04& 0.6& 0.01& 0.04 &[2]\\ {\rm''t\ Hout\ Case\ 3}& 0.0707&0.6067&
    0.0707& 0.2928& -0.7571& 0.03& 0.0 & [2]\\ {\rm''t\ Hout\ Case\ 4}& 0.06& 2.5&
    0.06& 0.5& -0.1& 0.0507& 0.0469 &[2]\\ {\rm Ikonen\ Toivanen}& 0.0625& 5& 0.16&
    0.9& 0.1& 0.1& 0.0 &[3]\\ {\rm Kahl\ J\ddot{a}ckel}& 0.16& 1.0& 0.16& 2.0& -0.8&
    0.0& 0.0 &[4]\\ {\rm Equity Case }& 0.07& 2.0& 0.04& 0.55& -0.8& 0.03& 0.035 &\\
    {\rm High Correlation}& 0.07& 1.0& 0.04& 0.55& 0.9& 0.02& 0.04& \\ {\rm small\
    \sigma_v}& 0.07& 1.0& 0.04& 0.001& -0.75& 0.04& 0.03& \\ \kappa_v=\sigma_v\rho_{Sv}&
    0.07& 0.4& 0.04& 0.5& 0.8& 0.03& 0.03 &\\ \hline \end{array}](img/8a1d96b49959d026fd532132c20528a2.png)'
  prefs: []
  type: TYPE_IMG
- en: The Hull-White parameters are set to ![\kappa_r=0.00883](img/ddb9df3178ad19dbe4537bbc6f50195a.png)
    and ![\sigma_r=0.00631](img/12ab387899bf0b296dc141f6c4a88298.png).  The equity
    interest rate correlation is ![\rho_{Sr}=-0.4](img/250841e435f90b53df6f4f1d805ecf66.png),
    interest rates and stochastic volatility aren’t correlated ![\rho_{vr}=0.](img/746cede13769b94e6ba0de21c54b5e4a.png)
    The benchmark call options have maturity of 5 years, underlying at time ![t=0](img/d925c5bbbf263db2307d348e86cc1b52.png)
    is ![S_0=100](img/8a8975d1e57fbbd505e85ee3ae5021db.png) and possible strikes are
  prefs: []
  type: TYPE_NORMAL
- en: '![K \in \{ 75,85,90,95,100,105,110,115,120,125,130,140,150 \}](img/0bb339ee6bdb688e2ae7e8dc53b4ff96.png).'
  prefs: []
  type: TYPE_NORMAL
- en: The benchmark value is the average relative difference between the reference
    values and the option prices on the lattice for the different ![N_s](img/982dc7afe26887cc3291b5f361934e36.png)
    strikes and ![N_m](img/8530946b069ba413e0106ab502b0fe31.png) models.
  prefs: []
  type: TYPE_NORMAL
- en: '![\zeta =\frac{1}{N_{s}N_{m}}\sum_{i=1}^{N_{s}N_{m}}\frac{{\rm npv_{ref}^i}-{\rm
    npv^i}}{K_i} ](img/0be6ba640727bc70af1d8f2cd07e6631.png)'
  prefs: []
  type: TYPE_IMG
- en: The diagram below shows the results of the “Equity Case” for different grid
    sizes ![\{ t, S, v, r\}](img/34b336f8ea203d980f4e2c4955d1d2ca.png). and with control
    variate based on the semi–closed Heston Model. Clearly the Douglas scheme is the
    worst performer, the (modified) Craig-Sneyd and modified Hundsdorfer-Verwer scheme
    are the winner.
  prefs: []
  type: TYPE_NORMAL
- en: '[![](img/bbba88bc139e987ffaa89244fd028182.png "plot")](https://hpcquantlib.wordpress.com/wp-content/uploads/2011/09/plot1.png)The
    overall average over the ten models is dominated by the two “pathological” parameter
    sets  “Ikonen-Toivanen” and “Kahl-Jäckel”. Again the Douglas scheme can not compete
    with the other schemes. The differences between the other schemes are comparable
    small except for the largest grid where the modified Hundsdorfer-Verwer scheme
    performs badly.'
  prefs: []
  type: TYPE_NORMAL
- en: '[![](img/aefaceacd8e7fb1f577b5984def84bba.png "plot")](https://hpcquantlib.wordpress.com/wp-content/uploads/2011/09/plot2.png)The
    relative pricing error with and without control variate is shown in the diagram
    below for the “Equity Case” Heston model and the modified Craig-Sneyd scheme.
    On average the usage of the control variate reduces the relative pricing error
    by a factor of 15.'
  prefs: []
  type: TYPE_NORMAL
- en: '[![](img/b76f8795643d6aae15635c0527a95515.png "plot")](https://hpcquantlib.wordpress.com/wp-content/uploads/2011/09/plot3.png)'
  prefs: []
  type: TYPE_NORMAL
- en: The source code is available [here](http://hpc-quantlib.de/src/fdmscheme.zip).
    It depends on [QuantLib 1.1](http://quantlib.org/download.shtml) or higher.If
    you want to generate the plots you’ll also need [R.](http://www.r-project.org/)
  prefs: []
  type: TYPE_NORMAL
- en: '[1] L. A. Grzelak, C. W. Oosterleea, Lech A., [On the Heston Model with Stochastic
    Interest Rates.](http://mpra.ub.uni-muenchen.de/24174/1/MPRA_paper_24174.pdf)'
  prefs: []
  type: TYPE_NORMAL
- en: '[2] K.J. in ‘t Hout, S. Foulon, [ADI finite difference schemes for option pricing
    in the Heston model with correlation.](http://www.math.ualberta.ca/ijnam/Volume-7-2010/No-2-10/2010-02-06.pdf)
    Int. J. Numer. Anal. Mod. **7**, 303-320 (2010).'
  prefs: []
  type: TYPE_NORMAL
- en: '[3]  S. Ikonen, J. Toivanen, [Operator Splitting Methods for American Options
    with Stochastic Volatility.](http://users.jyu.fi/~tene/papers/Ikonen.pdf)'
  prefs: []
  type: TYPE_NORMAL
- en: '[4] C. Kahl, P. Jäckel [Not-so-complex logarithms in the Heston model.](http://www2.math.uni-wuppertal.de/~kahl/publications/NotSoComplexLogarithmsInTheHestonModel.pdf)'
  prefs: []
  type: TYPE_NORMAL
