["```\n\nbt.simple <- function(data, signal) \n{\n\t# lag singal\n\tsignal = Lag(signal, 1)\n\n\t# back fill\n\tsignal = na.locf(signal, na.rm = FALSE)\n\tsignal[is.na(signal)] = 0\n\n\t# calculate Close-to-Close returns\n\tret = ROC(Cl(data), type='discrete')\n\tret[1] = 0\n\n\t# compute stats\t\n\tbt = list()\n\t\tbt$ret = ret * signal\n\t\tbt$equity = cumprod(1 + bt$ret)    \t    \t\n\treturn(bt)\n}\n\n# Test for bt.simple functions\nload.packages('quantmod')\n\n# load historical prices from Yahoo Finance\ndata = getSymbols('SPY', src = 'yahoo', from = '1980-01-01', auto.assign = F)\n\n# Buy & Hold\nsignal = rep(1, nrow(data))\nbuy.hold = bt.simple(data, signal)\n\n# MA Cross\nsma = SMA(Cl(data),200)\nsignal = ifelse(Cl(data) > sma, 1, 0)\nsma.cross = bt.simple(data, signal)\n\n# Create a chart showing the strategies perfromance in 2000:2009\ndates = '2000::2009'\nbuy.hold.equity = buy.hold$equity[dates] / as.double(buy.hold$equity[dates][1])\nsma.cross.equity = sma.cross$equity[dates] / as.double(sma.cross$equity[dates][1])\n\nchartSeries(buy.hold.equity, TA = c(addTA(sma.cross.equity, on=1, col='red')),\t\n\ttheme ='white', yrange = range(buy.hold.equity, sma.cross.equity) )\t\n\n```", "```\n\n# Load Systematic Investor Toolbox (SIT)\nsetInternet2(TRUE)\ncon = gzcon(url('https://github.com/systematicinvestor/SIT/raw/master/sit.gz', 'rb'))\n\tsource(con)\nclose(con)\n\n\t#*****************************************************************\n\t# Load historical data\n\t#****************************************************************** \t\n\tload.packages('quantmod')\n\ttickers = spl('SPY')\n\n\tdata <- new.env()\n\tgetSymbols(tickers, src = 'yahoo', from = '1970-01-01', env = data, auto.assign = T)\n\tbt.prep(data, align='keep.all', dates='1970::2011')\n\n\t#*****************************************************************\n\t# Code Strategies\n\t#****************************************************************** \n\tprices = data$prices    \n\n\t# Buy & Hold\t\n\tdata$weight[] = 1\n\tbuy.hold = bt.run(data)\t\n\n\t# MA Cross\n\tsma = bt.apply(data, function(x) { SMA(Cl(x), 200) } )\t\n\tdata$weight[] = NA\n\t\tdata$weight[] = iif(prices >= sma, 1, 0)\n\tsma.cross = bt.run(data, trade.summary=T)\t\t\t\n\n\t#*****************************************************************\n\t# Create Report\n\t#****************************************************************** \n\tplotbt.custom.report(sma.cross, buy.hold)\n\n```", "```\n\n> buy.hold = bt.run(data)\nPerformance summary :\n        CAGR    Best    Worst\n        7.2     14.5    -9.9\n\n> sma.cross = bt.run(data, trade.summary=T)\nPerformance summary :\n        CAGR    Best    Worst\n        6.3     5.8     -7.2\n\n```"]