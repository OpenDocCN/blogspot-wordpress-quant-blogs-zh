["```\n\n###############################################################################\n# Load Systematic Investor Toolbox (SIT)\n# https://systematicinvestor.wordpress.com/systematic-investor-toolbox/\n###############################################################################\nsetInternet2(TRUE)\ncon = gzcon(url('http://www.systematicportfolio.com/sit.gz', 'rb'))\n    source(con)\nclose(con)\n\n\t#*****************************************************************\n\t# Load historical fundamental and pricing data\n\t#****************************************************************** \n\tload.packages('quantmod') \n\ttickers = spl('AAPL')\n\ttickers.temp = spl('NASDAQ:AAPL')\n\n\t# get fundamental data\n\tdata.fund <- new.env()\n\tfor(i in 1:len(tickers))\n\t\tdata.fund[[tickers[i]]] = fund.data(tickers.temp[i], 80, 'annual')\n\n\t# get pricing data\n\tdata <- new.env()\n\tgetSymbols(tickers, src = 'yahoo', from = '1970-01-01', env = data, auto.assign = T)\n\t\tfor(i in ls(data)) data[[i]] = adjustOHLC(data[[i]], use.Adjusted=T)\t\t\t\n\n\t# prepare data\n\tfund = data.fund[[tickers[1]]]\n\tfund.date = date.fund.data(fund)\t\t\t\n\tprice = Cl(data[[tickers[1]]]['1995::'])\n\n```", "```\n\n\t#*****************************************************************\n\t# Extract Inputs for DCF Valuation\n\t#****************************************************************** \t\t\t\t\n\t# Free Cash Flows\n\tFCF = get.fund.data('free cash flow', fund, fund.date)\n\n\t# Invested Capital\n\tIC = get.fund.data('invested capital', fund, fund.date)\n\n\t# Sales\n\tSALE = get.fund.data('total revenue', fund, fund.date)\n\n\t# Common Equity\n\tCEQ = get.fund.data('total equity', fund, fund.date)\n\n\t# Common Shares Outstanding\n\tCSHO = get.fund.data('total common shares out', fund, fund.date)\n\n\t# Growth Rate\n\tCROIC = FCF/IC\n\n\t# Average inputs\n\tg = runMean(CROIC, 5)\n\tcash = runMean(FCF, 5)\n\n```", "```\n\n\t#*****************************************************************\n\t# Helper function to compute Intrinsic Value\n\t#****************************************************************** \t\t\t\t\n\tcompute.DCF.IV <- function(cash, eqity, shares, g, R) {\n\t\tif( cash <= 0 ) return(NA)\n\n\t\tif( len(R) == 1 ) R = rep(R, len(g))\n\n\t\tvalue = eqity + sum(cash * cumprod(1 + g) / cumprod(1 + R))\n\t\treturn( value / shares )\n\t}\n\n```", "```\n\n\t#*****************************************************************\n\t# Compute Intrinsic Value, assumptions:\n\t# Company will grow for the first 3 years at current Growth Rate\n\t# slowed down by 20% for the next 4 years, and slowed down by a further 20% for the next 3 years\n\t# and finally 3% growth for the next 10 years\n\t#\n\t# The Discount Rate is 9%\n\t#\n\t# http://www.oldschoolvalue.com/blog/stock-analysis/apple-aapl-valuation/\n\t#****************************************************************** \t\t\t\t\n\tdcf.price = NA * g\n\ti.start = which(!is.na(g))[1] \n\n\tfor(i in i.start : nrow(g)) {\n\t\t# Create Growth Rate scenario: \t\t\n\t\tg.scenario = c(rep(g[i],3), rep(g[i],4)*0.8, rep(g[i],3)*0.8*0.8, rep(3/100,10))\n\n\t\t# Compute Intrinsic Value\n\t\tdcf.price[i] = compute.DCF.IV(cash[i], CEQ[i], CSHO[i], g.scenario, 9/100)\n\t}\n\n\t#*****************************************************************\n\t# Create Plots\n\t#****************************************************************** \n\tplota(price, type='l', log = 'y', col='blue', main=tickers[1],\n\t\tylim=range(price,dcf.price,na.rm=T))\n\tplota.lines(dcf.price, type='s', col='red', lwd=2)\n\tplota.legend('Close,Intrinsic Value', 'blue,red', list(price, dcf.price))\t\n\n\tplota(g, type='b', col='blue', pch=0, main='Growth Rate')\t\n\n\tplota(cash, type='b', col='blue', pch=0, main='Free Cash Flows')\t\n\n```"]