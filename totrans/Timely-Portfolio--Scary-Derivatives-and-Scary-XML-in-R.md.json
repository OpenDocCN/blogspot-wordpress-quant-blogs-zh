["```\n#read xml derivatives data from the\n#US Treasury OCC Quarterly Derivatives Report\n#2 methods of as far as I can tell \n#the first published example of how to read\n#Microsoft Excel xml workbooks   require(XML)\nrequire(ggplot2)   url = \"http://www.occ.treas.gov/topics/capital-markets/financial-markets/trading/derivatives/dq410-xml.xml\"\n#url = \"dq410-xml.xml\"   doc = xmlInternalTreeParse(\"dq410-xml.xml\")\n#define namespaces\n#figuring this out took hours\n#but using getNodeSet was much cleaner than the\n#next method\nnamespaces = c(o=\"urn:schemas-microsoft-com:office:office\",\n\tx=\"urn:schemas-microsoft-com:office:excel\",\n\tss=\"urn:schemas-microsoft-com:office:spreadsheet\",\n\thtml=\"http://www.w3.org/TR/REC-html40\")\nns <- getNodeSet(doc,\"/ss:Workbook/ss:Worksheet[@ss:Name='Table 3']/ss:Table/ss:Row\",namespaces)[[44]]\npct <- df <- as.data.frame(as.numeric(xmlSApply(ns, xmlValue))[5:8])\nns <- getNodeSet(doc,\"/ss:Workbook/ss:Worksheet[@ss:Name='Table 3']/ss:Table/ss:Row\",namespaces)[[8]]\nlab <- as.character(xmlSApply(ns, xmlValue)[8:11])\ndf <- cbind(lab,df)\n#jpeg(filename=\"derivatives by type.jpg\",quality=100,\n#\twidth=6.25, height = 8,  units=\"in\",res=96)\nbarplot(df[,2],names.arg = df[,1],main=\"US Bank Derivatives by Type\n\tQ4 2010\",ylab=\"% of Total\")\nmtext(\"Source: US Dept of Treasury OCC Quarterly Derivatives Report\",\n\tside=1,line=3,cex=0.8,adj=0)\n#dev.off()       #here is the original very hacked brute force method\ndoc = xmlRoot(xmlTreeParse(url))\n#set xmlNodeList to Table 3\n#hacked with brute force\ntable3 <- doc[6]$Worksheet\ndf <- as.data.frame(cbind(\n\tas.numeric(\n\txmlApply(table3[[1]],function(x) xmlApply(x,xmlValue))[53]$Row[5:8])),\n\tstringsAsFactors=FALSE)\ndf <- cbind(\n\tas.character(xmlApply(table3[[1]],function(x) xmlApply(x,xmlValue))[17]$Row[c(8:11)]),\n\tdf)\ncolnames(df) <- c(\"DerivativeType\",\"PctOfTotal\")\nbarplot(df[,2],names.arg = df[,1],main=\"US Bank Derivatives by Type\n\tQ4 2010\",ylab=\"% of Total\")\nmtext(\"Source: US Dept of Treasury OCC Quarterly Derivatives Report\",\n\tside=1,line=3,cex=0.8,adj=0)\n```"]