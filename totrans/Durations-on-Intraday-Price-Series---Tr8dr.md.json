["```\nr ← {0} ∪ diff(log(series))\nt ← times (series)\ndurations ← {}\nfor (i in 2:length(r))\n{\n    # determine cumulative return since last acceptance\n    cumr ← *<cummulative return since last event or max cum window>*\n\n    # determine whether qualifying event has occurred\n    if (|cumr| ≥ threshold or |r[i]| ≥ threshold)\n        durations ← durations ∪ {t[i] - *<Tlastevent>*}\n}\n\n```"]