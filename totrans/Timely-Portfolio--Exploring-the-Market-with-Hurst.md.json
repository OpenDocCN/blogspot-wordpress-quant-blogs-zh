["```\nrequire(quantmod)\nrequire(PerformanceAnalytics)   #get DJIA since 1896 from St. Louis Fed Fred\ngetSymbols(\"DJIA\",src=\"FRED\")   #do monthly to shorten the lengthy calculation\n#on my old computer\nDJIA <- to.monthly(DJIA)[,4]\nretDJIA <- ROC(DJIA,n=1,type=\"discrete\")   #paper HURST EXPONENT AND FINANCIAL MARKET PREDICTABILITY by\n#Bo Qian and Khaled Rasheed use 1024 days or 4 years\n#or 208 weeks assuming 52 weeks/year\n#I first tried HurstIndex from PerformanceAnalytics\nhurst.48 <- apply.rolling(retDJIA, FUN=\"HurstIndex\", width=48)\nchart.TimeSeries(hurst.208,colorset=c(\"cadetblue\"),\n\tmain = \"Hurst Index (48 Month) for DJIA\n\t1896-2011\")\n#my results are very different from the research paper whether I use\n#daily, weekly, or monthly\n#so I must be doing something wrong\nhurst.avg <- apply.rolling(retDJIA, FUN=\"HurstIndex\", width=12)\nhurst.avg <- runMean(hurst.avg,n=48)\nhurst <- merge(hurst.48,hurst.avg)\ncolnames(hurst) <- c(\"Hurst 48 Month\",\"Hurst 4y Avg of 12 Month\")\nchart.TimeSeries(hurst,colorset=c(\"cadetblue\",\"darkolivegreen3\"),\n\tlegend.loc=\"bottomright\",\n\tmain = \"Hurst Index Comparison for DJIA\n\t1896-2011\")\nabline(h=0.5) #this represents no trend or mean reversion     #now let's try a different package\nrequire(FGN)\n#get DJIA since 1896 from St. Louis Fed Fred\ngetSymbols(\"DJIA\",src=\"FRED\")\n#will do daily; takes about 2 hours\n#on my old computer\nDJIA <- DJIA\nretDJIA <- ROC(DJIA,n=1)\n#about 2 hours for a result on my old computer\nhurstK <- apply.rolling(retDJIA, FUN=\"HurstK\", width=1024)\nchart.TimeSeries(hurstK,colorset=c\"cadetblue\",\n\tmain = \"HurstK Calculation of Hurst Exponent (1024 days) for DJIA\n\t1896-2011\")     #######system-building time\n#do monthly just to test more quickly\nDJIA <- to.monthly(DJIA)[,4]\nindex(DJIA) <- as.Date(index(DJIA))\nretDJIA<-ROC(DJIA,n=1,type=\"discrete\")\nindex(retDJIA) <- as.Date(index(retDJIA))\nhurstKmonthly <- apply.rolling(retDJIA, FUN=\"HurstK\", width = 12)\ncolnames(hurstKmonthly) <- \"HurstK.monthly\"\nindex(hurstKmonthly) <- as.Date(index(hurstKmonthly))\nserialcorr <- runCor(cbind(coredata(retDJIA)),cbind(index(retDJIA)),n=12)\nserialcorr <- as.xts(serialcorr,order.by=index(retDJIA))\nautoreg <- runCor(retDJIA,lag(retDJIA,k=1),n=12)\ncolnames(serialcorr) <- \"SerialCorrelation.monthly\"\ncolnames(autoreg) <- \"AutoRegression.monthly\"\n#check for correlation of potential signals\nchart.Correlation(merge(hurstKmonthly,serialcorr,autoreg))\n#try a sum to enter in strong trends\nsignal <- hurstKmonthly+serialcorr+autoreg\ncolnames(signal) <- \"HurstCorrelationSum\"\nchart.TimeSeries(signal)\nsignal <- lag(signal,k=1)\nretSys <- ifelse(signal > 0.1, 1, 0) * retDJIA\n#charts.PerformanceSummary(retSys,ylog=TRUE)\n#ok performance but let's see if we can enter\n#only strong trends up and reduce the drawdown\nsignalUpTrend <- runMean(hurstKmonthly+serialcorr+autoreg,n=6) + (DJIA/runMean(DJIA,n=12)-1)*10\nchart.TimeSeries(signalUpTrend)\nsignalUpTrend <- lag(signalUpTrend,k=1)\nretSys <- merge(retSys,ifelse(signalUpTrend > 1, 1, 0) * retDJIA,retDJIA)\ncolnames(retSys) <- c(\"DJIA Hurst System\",\"DJIA HurstUp System\",\n\t\"DJIA\")\ncharts.PerformanceSummary(retSys,ylog=TRUE,cex.legend=1.25,\n\tcolorset=c(\"cadetblue\",\"darkolivegreen3\",\"gray70\"))   #now let's take it out of sample to see how it works\ngetSymbols(\"^N225\",from=\"1980-01-01\",to=format(Sys.Date(),\"%Y-%m-%d\"))\nN225 <- to.monthly(N225)[,4]\nindex(N225) <- as.Date(index(N225))\nretN225<-ROC(N225,n=1,type=\"discrete\")\nindex(retN225) <- as.Date(index(retN225))\nhurstKmonthly <- apply.rolling(retN225, FUN=\"HurstK\", width = 12)\ncolnames(hurstKmonthly) <- \"HurstK.monthly\"\nindex(hurstKmonthly) <- as.Date(index(hurstKmonthly))\nserialcorr <- runCor(cbind(coredata(retN225)),cbind(index(retN225)),n=12)\nserialcorr <- as.xts(serialcorr,order.by=index(retN225))\nautoreg <- runCor(retN225,lag(retN225,k=1),n=12)\ncolnames(serialcorr) <- \"SerialCorrelation.monthly\"\ncolnames(autoreg) <- \"AutoRegression.monthly\"\nsignalUpTrend <- runMean(hurstKmonthly+serialcorr+autoreg,n=6) + (N225/runMean(N225,n=12)-1)*10\nchart.TimeSeries(signalUpTrend)\nsignalUpTrend <- lag(signalUpTrend,k=1)\nretSys <- merge(ifelse(signalUpTrend > 1, 1, 0) * retN225,retN225)\ncolnames(retSys) <- c(\"Nikkei 225 HurstUp System\",\"Nikkei 225\")\ncharts.PerformanceSummary(retSys,ylog=TRUE,cex.legend=1.25,\n\tcolorset=c(\"cadetblue\",\"darkolivegreen3\"))\n###########################\n```"]