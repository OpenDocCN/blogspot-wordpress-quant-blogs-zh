["```\n#this bit of code will show a system after significant\n#optimization and hindsight bias\n#without any out-of-sample testing\n#explore how SP500 behaves in different ranges of Financial Conditions\n#see previous posts for more discussion   \n```", "```\nrequire(quantmod)\nrequire(PerformanceAnalytics)\nrequire(ggplot2)   #get data from St. Louis Federal Reserve (FRED)\ngetSymbols(\"SP500\",src=\"FRED\") #load SP500\ngetSymbols(\"ANFCI\",src=\"FRED\") #load Adjusted Chicago Financial\ngetSymbols(\"CFNAI\",src=\"FRED\") #load Chicago National Activity\n#do not use this but here in case you want to play\ngetSymbols(\"PANDI\",src=\"FRED\") #load Chicago Fed Production and Income     \n```", "```\n#do a little manipulation to get the data lined up on weekly basis\nSP500  <-  to.monthly(SP500)[,4]\nANFCI <- to.monthly(ANFCI)[,4]\nCFNAI <- to.monthly(CFNAI)[,4]\nPANDI <- to.monthly(PANDI)[,4]\nindex(SP500) <- as.Date(index(SP500))\nindex(ANFCI) <- as.Date(index(ANFCI))\nindex(CFNAI) <- as.Date(index(CFNAI))\nindex(PANDI) <- as.Date(index(PANDI))     \n```", "```\nSP500_ANFCI <- na.omit(merge(ROC(SP500,n=1,type=\"discrete\"),\n\tANFCI,CFNAI,PANDI))         \n```", "```\n#and just for fun an enhanced very basic system\nsignal <- runSum(-0.25*SP500_ANFCI[,2]-SP500_ANFCI[,3],n=4)\nchartSeries(signal, name=\"Chicago Fed Signal\")\nsignal <- lag(signal,k=1)\n#go long if extremely negative (signal>10)\n#or good but not too good (signal between -.25 and -2)\nret <- ifelse(signal>10 | (signal <= -0.25  & signal > -2.25) , 1, 0) * SP500_ANFCI[,1]\nret <- merge(ret, SP500_ANFCI[,1])\ncolnames(ret) <- c(\"ChicagoFed_LongOnlySystem\",\"SP500\")\ncharts.PerformanceSummary(ret, ylog=TRUE, main=\"Over-optimized Chicago Fed S&P 500 System\",\n\tcolorset=c(\"cadetblue\",\"darkolivegreen3\"))     \n```", "```\n#I really like the boxplot by range, so let's do the same here\ndf <- na.omit(merge(round(signal,0),ROC(SP500,n=1,type=\"discrete\")))\ndf <- as.data.frame(cbind(index(df),\n\tcoredata(df)))\ncolnames(df) <- c(\"date\",\"ChiFedSignal\",\"SP500return\")\nggplot(df,aes(factor(ChiFedSignal),SP500return)) +\n\tgeom_boxplot(aes(colour = factor(ChiFedSignal))) +\n\topts(title=\"Box Plot of SP500 Monthly Change by Chicago Fed Signal\")\n```"]