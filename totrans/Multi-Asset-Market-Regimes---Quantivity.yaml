- en: <!--yml
  prefs: []
  type: TYPE_NORMAL
- en: 'category: 未分类'
  prefs: []
  type: TYPE_NORMAL
- en: 'date: 2024-05-18 13:44:02'
  prefs: []
  type: TYPE_NORMAL
- en: -->
  prefs: []
  type: TYPE_NORMAL
- en: Multi-Asset Market Regimes | Quantivity
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 来源：[https://quantivity.wordpress.com/2012/11/09/multi-asset-market-regimes/#0001-01-01](https://quantivity.wordpress.com/2012/11/09/multi-asset-market-regimes/#0001-01-01)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'An astute reader suggested reproducing the results from a recent article on
    regime analysis by Kritzman *et al.*, [Regime Shifts: Implications for Dynamic
    Strategies](http://www.cfapubs.org/doi/abs/10.2469/faj.v68.n3.3) in FAJ (May /
    June 2012). This is a fun exercise to be conducted over a series of posts, as
    doing so illustrates several important economic principles and some elegant mathematics.'
  prefs: []
  type: TYPE_NORMAL
- en: This post begins by identifying *macroeconomic market regimes arising from multi-asset
    economic activity*.
  prefs: []
  type: TYPE_NORMAL
- en: One big challenge in analyzing market regimes is *identification*, as they are
    not directly observable. As an unsupervised statistical learning problem, there
    is no verifiable “right answer”. Beyond identifying regimes, we also want to know
    the probability of being in a given regime at any given point in time. Finally,
    our economic activity is measured via time series.
  prefs: []
  type: TYPE_NORMAL
- en: 'Fortunately, a standard ML technique exists which possesses these attributes:
    *hidden Markov model* (HMM). For readers unfamiliar with HMM, here is a brief
    summary on the theory relevant to our problem. See [Hidden Markov Models for Time
    Series](http://books.google.com/books?id=LDDzvCsdVs8C) by Zucchini and MacDonald
    (2009) for more details.'
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: 'HMMs are useful because they estimate both unobserved regimes and corresponding
    probabilities of being in each regime at every point in time. The latter is termed
    “local decoding”, and expressed as the conditional state probabilities:'
  prefs: []
  type: TYPE_NORMAL
- en: '![\text{Pr}(C_t = i | \bf{X}_T = \bf{x}_T) = \frac{\text{Pr}(C_t = i, \bf{X}^T
    = \bf{x}^T)}{\text{Pr}(\bf{X}^T = \bf{x}^T)} ](img/43c998972f4db32390ad14e4e67c2032.png)'
  prefs: []
  type: TYPE_IMG
- en: In other words, the probability of being in regime ![i](img/6aed483d693a0743f647c27ec4372c2a.png)
    at time ![t](img/867074ff782cf54112401c2854672245.png) given the observed data
    ![\bf{x}_T](img/0fbdfc5bff27e909029f6bd9929ffbb8.png).
  prefs: []
  type: TYPE_NORMAL
- en: 'Where ![\bf{X}](img/743e9374d3bd8e0d1917c6eecd378c69.png) is the observed time-series
    data and ![C](img/e5cf91abc25ecaf404555860373f6acc.png) is an unobserved parameter
    process which conditional probability at time ![t](img/867074ff782cf54112401c2854672245.png)
    depends at most on the previous time ![(t-1)](img/e3728df24f080663fcacff3ec19c3d71.png),
    also known as the Markov property:'
  prefs: []
  type: TYPE_NORMAL
- en: '![\text{Pr}(C_{t+1} | C_t, ..., C_1) = \text{Pr}(C_{t+1} | c_t) ](img/659b403325591b22e0235c1b0d2a7c23.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Thus, ![C](img/e5cf91abc25ecaf404555860373f6acc.png) is an unobservable Markov
    chain; because of which the conditional probability at time ![t](img/867074ff782cf54112401c2854672245.png)
    nicely reduces to (see equation 5.6 in Zucchini, derived from 4.9):'
  prefs: []
  type: TYPE_NORMAL
- en: '![\text{Pr}(C_{t+1} | C_t, ..., C_1) = \frac{\alpha_t(i) \beta_t(i)}{L_T} ](img/e0a4ab5aca9c0f1c68c7c730c406b4ce.png)'
  prefs: []
  type: TYPE_IMG
- en: Where ![\alpha_t(i)](img/025978225a011eb121a8885e15e39e5d.png) and ![\beta_t(i)](img/7eded08f9086c498ad8a0d7e863ee5bc.png)
    are forward and backward probabilities along the Markov chain ![C](img/e5cf91abc25ecaf404555860373f6acc.png)
    at time ![t](img/867074ff782cf54112401c2854672245.png) (estimated via iterative
    maximum likelihood using [expectation maximization](http://en.wikipedia.org/wiki/Expectation%E2%80%93maximization_algorithm)),
    and ![L_T](img/0461003fca3149edd411432b5b6add66.png) is the likelihood at time
    ![T ](img/7b0bfb2af3868c86a2b58befff3cc01d.png).
  prefs: []
  type: TYPE_NORMAL
- en: 'For those who prefer code, where `val` is observed time series ![\bf{X}](img/743e9374d3bd8e0d1917c6eecd378c69.png)
    and `numOfStates` is number of unobserved regimes for ![C](img/e5cf91abc25ecaf404555860373f6acc.png):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Readers with ML background will recognize HMM as an elementary temporal graphical
    model (see § 6.2 of [Koller and Friedman (2009)](http://books.google.com/books?id=7dzpHCHzNQ4C)).
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: With this tiny bit of HMM theory, we can now formulate our regime analysis problem
    in economic terms and use a bit of R to solve it.
  prefs: []
  type: TYPE_NORMAL
- en: 'Consider four measures of economic activity: US equities, real gross domestic
    product (GDP), inflation, and G10 currencies. Posit each measure of economic activity
    can be characterized at any point in time as being in either one of *two* states:
    stable with corresponding small downside volatility or contracting with corresponding
    high volatility. This broadly matches traditional wisdom, namely the macroeconomy
    is either acting “fairly normal” or is exceptional (either panic or exuberance).'
  prefs: []
  type: TYPE_NORMAL
- en: Worth noting is the obvious caveat that this bi-state model oversimplifies reality,
    in particular ignoring potential distinction between “growth” and “stagnancy”
    (of potential importance during 1970s and 2010s). Intuition is unclear *a priori*
    whether a bi- or tri-state model is preferable. A subsequent post will take up
    this model selection question, as it lacks an easy answer.
  prefs: []
  type: TYPE_NORMAL
- en: 'Illustrating the conditional probabilities of this model graphically, where
    a value of 0 indicates 100% likelihood of being in the “normal” regime and value
    of 1 indicates 100% likelihood of being in “exceptional” regime:'
  prefs: []
  type: TYPE_NORMAL
- en: '[![](img/77db4672c4dba2f1f81b40247f4ed57b.png "hmm-regime-state-probs")](https://quantivity.wordpress.com/wp-content/uploads/2012/11/hmm-regime-state-probs.png)'
  prefs: []
  type: TYPE_NORMAL
- en: These regimes match our economic recollection. Equities were normal through
    much of the 1990s and mid-2000, and in panic the remaining time. GDP growth was
    exceptionally strong in the mid-1990s, during recovery from dotcom bubble in early
    2000s, and during recovery of mortgage bubble in late 2000s; growth during all
    other times was “normal”. Inflation was high during the late 1970s and flanking
    the mortgage bubble. Currencies were volatile throughout 1980s and 1990s and then
    again flanking the mortgage bubble.
  prefs: []
  type: TYPE_NORMAL
- en: These regimes also illustrate just how unusual the mortgage bubble was in historical
    sense, as it is the only time in the past 30 years during which all four measures
    of macroeconomic activity were simultaneously in exceptional regime.
  prefs: []
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: Code to replicate the above results, and quite a bit more to be discussed in
    subsequent posts.
  prefs: []
  type: TYPE_NORMAL
- en: 'Note: US equity regime is estimated using daily returns from SPX, rather than
    equally-weighted basket of S&P 500 sector indices as in the original article.
    Doing so results in nearly identical equity regime conditional probabilities,
    hence SPX is chosen in recognition of Occam.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
