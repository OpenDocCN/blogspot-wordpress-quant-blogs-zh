["```\n#use Ken French momentum style indexes for style analysis\n#http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/ftp/6_Portfolios_ME_Prior_12_2.zip   require(PerformanceAnalytics)\nrequire(FactorAnalytics)\nrequire(quantmod)   my.url=\"http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/ftp/6_Portfolios_ME_Prior_12_2.zip\"\nmy.tempfile<-paste(tempdir(),\"\\\\frenchmomentum.zip\",sep=\"\")\nmy.usefile<-paste(tempdir(),\"\\\\6_Portfolios_ME_Prior_12_2.txt\",sep=\"\")\ndownload.file(my.url, my.tempfile, method=\"auto\", \n\tquiet = FALSE, mode = \"wb\",cacheOK = TRUE)\nunzip(my.tempfile,exdir=tempdir(),junkpath=TRUE)\n#read space delimited text file extracted from zip\nfrench_momentum <- read.table(file=my.usefile,\n\theader = TRUE, sep = \"\",\n\tas.is = TRUE,\n\tskip = 12, nrows=1017)\ncolnames(french_momentum) <- c(paste(\"Small\",\n\tcolnames(french_momentum)[1:3],sep=\".\"),\n\tpaste(\"Large\",colnames(french_momentum)[1:3],sep=\".\"))   #get dates ready for xts index\ndatestoformat <- rownames(french_momentum)\ndatestoformat <- paste(substr(datestoformat,1,4),\n\tsubstr(datestoformat,5,7),\"01\",sep=\"-\")   #get xts for analysis\nfrench_momentum_xts <- as.xts(french_momentum[,1:6],\n\torder.by=as.Date(datestoformat))   french_momentum_xts <- french_momentum_xts/100   #get price series from monthly returns\nfrench_price<-as.xts(\n\tapply(1+coredata(french_momentum_xts[,1:6]),MARGIN=2,cumprod),\n\tindex(french_momentum_xts))\n#check data for reasonability\nplot.zoo(french_price,log=\"y\")   #for this example let's use Bill Miller's fund\ngetSymbols(\"LMVTX\",from=\"1896-01-01\", to=Sys.Date(), adjust=TRUE)\nLMVTX <- to.monthly(LMVTX)\nindex(LMVTX) <- as.Date(format(as.Date(index(LMVTX)),\"%Y-%m-01\"))\nLMVTX.roc <- ROC(LMVTX[,4],type=\"discrete\",n=1)   perfComp <- na.omit(merge(LMVTX.roc,french_momentum_xts))   chart.RollingStyle(perfComp[,1],perfComp[,2:NCOL(perfComp)],\n\twidth=36,\n\tcolorset=c(\"darkseagreen1\",\"darkseagreen3\",\"darkseagreen4\",\"slateblue1\",\"slateblue3\",\"slateblue4\"),\n\tmain=\"LMVTX Rolling 36mo French Momentum Weights\")\n#could use the packaged chart.Style but does not allow the\n#flexibility I would like\n#chart.Style(perfComp[,1],perfComp[,2:NCOL(perfComp)],\n#\tcolorset=c(\"darkseagreen1\",\"darkseagreen3\",\"darkseagreen4\",\"slateblue1\",\"slateblue3\",\"slateblue4\"),\n#\tmain=\"LMVTX French Momentum Weights\")   #get weights for the cumulative period\nstyle.weight <- as.matrix(style.fit(perfComp[,1],\n\tperfComp[,2:NCOL(perfComp)])$weights)\nbarplot(style.weight,beside=TRUE,ylim=c(0,max(style.weight)+0.2),\n\tnames.arg=rownames(style.weight),cex.names=0.7,\n\tcol=c(\"darkseagreen1\",\"darkseagreen3\",\"darkseagreen4\",\n\t\t\"slateblue1\",\"slateblue3\",\"slateblue4\"),\n\tmain=paste(\"LMVTX French Momentum Weights\n\tSince \",format(index(LMVTX)[1],\"%b %Y\"),sep=\"\"))   #look at total R to determine goodness of fit\nstyle.R <- style.fit(perfComp[,1],\n\tperfComp[,2:NCOL(perfComp)])$R.squared     styleR <- function(x) {\n\tas.numeric(style.fit(R.fund=x[,1,drop=FALSE],R.style=x[,2:NCOL(x),drop=FALSE],method=\"constrained\",selection=\"none\",leverage=FALSE)$R.squared)\n}\n#convert to matrix since I get\n#error \"The data cannot be converted into a time series.\"\n#when I use xts as data\nstyle.RollingR <- as.xts(rollapply(data=as.matrix(perfComp),\n\twidth=12,FUN=styleR,by.column=FALSE,by=1),\n\torder.by=index(perfComp)[12:NROW(perfComp)])\nchart.TimeSeries(style.RollingR,ylab=\"Rolling 12-mo R\",\n\tmain=paste(\"LMVTX Rolling R versus French Momentum\n\tSince \",format(index(LMVTX)[1],\"%b %Y\"),sep=\"\"))\nabline(h=style.R,col=\"indianred\")\ntext(x=1,y=style.R,labels=\"r for entire series\",adj=0,col=\"indianred\")\n```"]