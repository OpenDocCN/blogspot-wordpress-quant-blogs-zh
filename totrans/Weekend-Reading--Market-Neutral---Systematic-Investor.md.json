["```\n\n###############################################################################\n# Load Systematic Investor Toolbox (SIT)\n# https://systematicinvestor.wordpress.com/systematic-investor-toolbox/\n###############################################################################\nsetInternet2(TRUE)\ncon = gzcon(url('http://www.systematicportfolio.com/sit.gz', 'rb'))\n    source(con)\nclose(con)\n\n\t#*****************************************************************\n\t# Load historical data\n\t#******************************************************************    \n\tload.packages('quantmod')\t\t\n\n\tdata = new.env()\n\n\t# load historical market returns\n\ttemp = get.fama.french.data('F-F_Research_Data_Factors', periodicity = '',download = T, clean = T)\n\t\tret = temp[[1]]$Mkt.RF + temp[[1]]$RF\n\t\tprice = bt.apply.matrix(ret / 100, function(x) cumprod(1 + x))\n\tdata$SPY = make.stock.xts( price )\n\n\t# load historical momentum returns\n\ttemp = get.fama.french.data('10_Portfolios_Prior_12_2', periodicity = '',download = T, clean = T)\t\t\n\t\tret = temp[[1]]\n\t\tprice = bt.apply.matrix(ret / 100, function(x) cumprod(1 + x))\n\tdata$HI.MO = make.stock.xts( price$High )\n\tdata$LO.MO = make.stock.xts( price$Low )\n\n\t# align dates\n\tbt.prep(data, align='remove.na')\n\n\t#*****************************************************************\n\t# Code Strategies\n\t#*****************************************************************\t\n\tmodels = list()\n\n\tdata$weight[] = NA\n\t\tdata$weight$SPY[] = 1\n\tmodels$SPY = bt.run.share(data, clean.signal=T)\n\n\tdata$weight[] = NA\n\t\tdata$weight$HI.MO[] = 1\n\tmodels$HI.MO = bt.run.share(data, clean.signal=T)\n\n\tdata$weight[] = NA\n\t\tdata$weight$LO.MO[] = 1\n\tmodels$LO.MO = bt.run.share(data, clean.signal=T)\n\n\tdata$weight[] = NA\n\t\tdata$weight$HI.MO[] = 1\n\t\tdata$weight$LO.MO[] = -1\n\tmodels$MKT.NEUTRAL = bt.run.share(data, clean.signal=F)\n\n\t#*****************************************************************\n\t# Modified MN\n\t# The modified strategy below starts 100% market neutral, and depending on the drawdown bucket \n\t# will reduce the shorts all the way to zero once the market has declined by 50%\n\t# (in 20% steps for every 10% decline in stocks)\n\t#*****************************************************************\t\n\tmarket.drawdown = -100 * compute.drawdown(data$prices$SPY)\n\t\tmarket.drawdown.10.step = 10 * floor(market.drawdown / 10)\n\t\tshort.allocation = 100 - market.drawdown.10.step * 2\n\t\tshort.allocation[ short.allocation < 0 ] = 0\n\n\tdata$weight[] = NA\n\t\tdata$weight$HI.MO[] = 1\n\t\tdata$weight$LO.MO[] = -1 * short.allocation / 100\n\tmodels$Modified.MN = bt.run.share(data, clean.signal=F)\n\n\t#*****************************************************************\n\t# Create Report\n\t#*****************************************************************\n\tstrategy.performance.snapshoot(models, T)\n\n```"]