<!--yml
category: 未分类
date: 2024-05-12 18:57:34
-->

# Quantitative Trading: Another "universal" capital allocation algorithm

> 来源：[http://epchan.blogspot.com/2014/07/another-universal-capital-allocation.html#0001-01-01](http://epchan.blogspot.com/2014/07/another-universal-capital-allocation.html#0001-01-01)

Financial engineers are accustomed to borrowing techniques from scientists in other fields (e.g. genetic algorithms), but rarely does the borrowing go the other way. It is therefore surprising to hear about this

[paper](http://www.pnas.org/content/early/2014/06/11/1406556111.abstract)

on a possible mechanism for evolution due to natural selection which is inspired by universal capital allocation algorithms.

A capital allocation algorithm attempts to optimize the allocation of capital to stocks in a portfolio. An allocation algorithm is called

*universal*

if it results in a net worth that is "similar" to that generated by the best constant-rebalanced portfolio with fixed weightings over time (denoted CBAL* below), chosen in hindsight. "Similar" here means that the net worth does not diverge exponentially. (For a precise definition, see this very readable 

[paper](http://arxiv.org/pdf/1107.0036.pdf)

by Borodin,

*et al*

. H/t: Vladimir P.)

Previously, I know only of one such universal trading algorithm - the Universal Portfolio invented by Thomas Cover, which I have described 

[before](http://epchan.blogspot.ca/2007/01/universal-portfolios.html)

. But here is another one that has proven to be universal: the exceedingly simple 

[EG algorithm](http://www.cis.upenn.edu/~mkearns/finread/helmbold98line.pdf)

.

The EG ("Exponentiated Gradient") algorithm is an example of a capital allocation rule using "multiplicative updates": the new capital allocated to a stock is proportional to its current capital multiplied by a factor. This factor is an exponential function of the return of the stock in the last period. This algorithm is both greedy and conservative: greedy because it always allocates more capital to the stock that did well most recently; conservative because there is a penalty for changing the allocation too drastically from one period to the next. This multiplicative update rule is the one proposed as a model for evolution by natural selection.

The computational advantage of EG over the Universal Portfolio is obvious: the latter requires a weighted average over all possible allocations at every step, while the former needs only know the allocation and returns for the most recent period. But does this EG algorithm actually generate good returns in practice? I tested it two ways:

1) Allocate between cash (with 2% per annum interest) and SPY.

2) Allocate among SP500 stocks.

In both cases, the only free parameter of the model is a number called the "learning rate" η, which determines how fast the allocation can change from one period to the next. It is generally found that η=0.01 is optimal, which we adopted. Also, we disallow short positions in this study.

The benchmarks for comparison for 1) are, using the notations of the Borodin paper,

a)  the buy-and-hold SPY portfolio

**BAH**

, and

b) the best constant-rebalanced portfolio with fixed allocations in hindsight

**CBAL***

.

The benchmarks for comparison for 2)  are

a) a constant rebalanced portfolio of SP500 stocks with equal allocations

**U-CBAL**

,

b) a portfolio with 100% allocation to the best stock chosen in hindsight

**BEST1**

, and

c)

**CBAL***

.

To find CBAL* for a SP500 portfolio, I used Matlab Optimization Toolbox's constrained optimization function

*fmincon*

.

There is also the issue of SP500 index reconstitution. It is complicated to handle the addition and deletion of stocks in the index within a constrained optimization function. So I opted for the shortcut of using a subset of stocks that were in SP500 from 2007 to 2013, tolerating the presence of surivorship bias. There are only 346 such stocks.

The result for 1) (cash vs SPY) is that the CAGR (compound annualized growth rate) of EG is slightly lower than BAH (4% vs 5%). It turns out that BAH and CBAL* are the same: it was best to allocate 100% to SPY during 2007-2013, an unsurprising recommendation in hindsight.

The result for 2) is that the CAGR of EG is higher than the equal-weight portfolio (0.5% vs 0.2%). But both these numbers are much lower than that of BEST1 (39.58%), which is almost the same as that of CBAL* (39.92%). (Can you guess which stock in the current SP500 generated the highest CAGR? The answer, to be revealed below*, will surprise you!)

We were promised that the EG algorithm will perform "similarly" to CBAL*, so why does it underperform so miserably? Remember that similarity here just means that the divergence is sub-exponential: but even a polynomial divergence can in practice be substantial! This seems to be a universal problem with universal algorithms of asset allocation: I have never found any that actually achieves significant returns in the short span of a few years. Maybe we will find more interesting results with higher frequency data.

So given the underwhelming performance of EG, why am I writing about this algorithm, aside from its interesting connection with biological evolution? That's because it serves as a setup for another,

*non*

-universal, portfolio allocation scheme, as well as a way to optimize parameters for trading strategies in general: both topics for another time

===

**Workshops Update:**

My next online workshop will be on  

[Mean Reversion Strategies](http://www.epchan.com/my-workshops/)

, August 26-28\.

[This](http://www.nbs.ntu.edu.sg/Executive_Education/NTU_SGX_Centre_for_Financial_Education/Documents/ATC-%20MEAN%20REVERSION%20STRATEGIES.pdf)

and the

[Quantitative Momentum](http://www.nbs.ntu.edu.sg/Executive_Education/NTU_SGX_Centre_for_Financial_Education/Documents/ATC-%20QUANTITATIVE%20MOMENTUM%20STRATEGIES.pdf)

workshops will also be conducted live at Nanyang Technological University in Singapore, September 18-21.

**===**

Do follow me

[@chanep](https://twitter.com/intent/follow?original_referer=http%3A%2F%2Fepchan.blogspot.ca%2F&region=follow_link&screen_name=chanep&tw_p=followbutton&variant=2.0)

 on Twitter, as I often post links to interesting articles there.

**===**

*The SP500 stock that generated the highest return from 2007-2013 is AMZN.