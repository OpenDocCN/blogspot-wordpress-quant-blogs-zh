- en: <!--yml
  prefs: []
  type: TYPE_NORMAL
- en: 'category: 未分类'
  prefs: []
  type: TYPE_NORMAL
- en: 'date: 2024-05-13 00:13:24'
  prefs: []
  type: TYPE_NORMAL
- en: -->
  prefs: []
  type: TYPE_NORMAL
- en: 'Moment Matching Option Pricing: A Case Study – HPC-QuantLib'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 来源：[https://hpcquantlib.wordpress.com/2019/11/26/moment-matching-option-pricing-a-case-study/#0001-01-01](https://hpcquantlib.wordpress.com/2019/11/26/moment-matching-option-pricing-a-case-study/#0001-01-01)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: The moment generating function of a random variable *Z* is
  prefs: []
  type: TYPE_NORMAL
- en: '![M_Z(\theta) := E\left(e^{\theta Z}\right) , \ \theta\in \mathbb{R}](img/fe23617925504d96684f4c15b8af2d21.png)'
  prefs: []
  type: TYPE_IMG
- en: and the *n*-th moment of the probability distribution *Z* is then given by
  prefs: []
  type: TYPE_NORMAL
- en: '![\displaystyle m_n=E\left(Z^n\right) = M_Z^{(n)}(0) = \frac{d^n M_Z(\theta)}{d\theta^n}\bigg\rvert_{\theta=0}](img/5f664dc216bebde5e7bc03b0acf0d012.png)'
  prefs: []
  type: TYPE_IMG
- en: The moment generating function is known for many financial models. Hence it
    is natural to derive approximations to exact pricing formulas based on the moment
    generating function.
  prefs: []
  type: TYPE_NORMAL
- en: The Kluge model [1] with exponential jump size distribution may serve here as
    a test bed for this approach. It is defined by
  prefs: []
  type: TYPE_NORMAL
- en: '![\displaystyle \begin{array}{rcl} S_t &=& \exp(f_t + X_t + Y_t) \\ dX_t &=&
    -\alpha X_tdt + \sigma dW_t^x \\ dY_t &=& -\beta Y_{t-}dt+J_tdN_t \\ \omega(J)
    &=& \eta e^{-\eta J} \end{array} ](img/71ee40e5982f6748faffab6247f9278b.png)'
  prefs: []
  type: TYPE_IMG
- en: where ![N_t](img/c6d44fd3b9c210c1d0e71a4a31edb3dc.png) is a Poisson process
    with jump intensity ![\lambda](img/4a42b8a415b6b944138e18b71269a40a.png) and ![\eta](img/3d744e5faf1efbb1fd86f7d17ef67fec.png)
    is the inverse jump size. To match today’s forward curve ![F_0^t](img/421429e49cb430d88afd689dbfe570cc.png)
    the function ![f_t](img/f963c39a6323c381d376d8074fc65006.png) is given by
  prefs: []
  type: TYPE_NORMAL
- en: '![\displaystyle f_t = \ln F_0^t -X_0 e^{-\alpha t}-Y_o e^{-\beta t} -\frac{\sigma^2}{4\alpha}\left(1-e^{-2\alpha
    t} \right ) - \frac{\lambda}{\beta}\ln\left( \frac{\eta-e^{-\beta t}}{\eta-1}\right),
    \eta\ge 1 ](img/2b3ad4e6ae2eba9d5316e5e0253cbd3e.png)'
  prefs: []
  type: TYPE_IMG
- en: The moment generating function for the log spot process
  prefs: []
  type: TYPE_NORMAL
- en: '![Z_t = \ln S_t = f_t+X_t+Y_t](img/a293d8acdbd5e262abd4223736f13217.png)'
  prefs: []
  type: TYPE_IMG
- en: is then given by [1]
  prefs: []
  type: TYPE_NORMAL
- en: '![\displaystyle M_Z(t) = \exp\left( \theta f_t + \theta X_0 e^{-\alpha t} +
    \theta^2 \frac{\sigma^2}{4\alpha}\left(1-2e^{-2\alpha t}\right) + \theta Y_0e^{-\beta
    t}\right) \left( \frac{\eta-\theta e^{-\beta t}}{\eta-\theta}\right)^\frac{\lambda}{\beta}](img/e5e1133417f9c4ceac0f9275c4d0391d.png)'
  prefs: []
  type: TYPE_IMG
- en: The pricing approximation formulas are based on the central moments
  prefs: []
  type: TYPE_NORMAL
- en: '![\displaystyle \mu_n = E\left[\left(Z-E(Z)\right)^n\right] = \sum_{i=0}^n
    {n\choose i} m_i (-E(Z))^{n-i}](img/cf5eea80663cdf7c10d1e58b075aa5c2.png)'
  prefs: []
  type: TYPE_IMG
- en: Mathematica calculates the first four central moments as
  prefs: []
  type: TYPE_NORMAL
- en: '![\begin{array}{rcl} \displaystyle \mu_1&=&0 \\ \displaystyle \mu_2 &=& \frac{\sigma^2
    \left(1-e^{-2 \alpha t}\right)}{2\alpha }+\frac{\lambda \left(1- e^{-2 \beta t}\right)}{\beta
    \eta ^2}\\ \mu_3 &=& \frac{\lambda \left(2-2 e^{-3 \beta t}\right)}{\beta \eta
    ^3} \\ \displaystyle \mu_4 &=& \frac{3 e^{-5 t (\alpha +\beta )} \left(16 \alpha
    ^2 \beta \lambda e^{5 \alpha t+3 \beta t} \sinh (2 \beta t)+e^{t (\alpha +\beta
    )} \left(\beta \eta ^2 \sigma^2 \left(e^{2 \alpha t}-1\right) e^{2 \beta t}+2
    \alpha \lambda e^{2 \alpha t} \left(e^{2 \beta t}-1\right)\right)^2\right)}{4
    \alpha ^2 \beta ^2 \eta ^4}.\end{array}](img/9170a7ae9f54bd9502c6d88dcb7ad4b7.png)'
  prefs: []
  type: TYPE_IMG
- en: Approximations to Black-Scholes like log-normal models with higher moments are
    summarized in [2]. These extensions are parameterized in terms of the Fisher parameters
    for sknewness and kurtosis
  prefs: []
  type: TYPE_NORMAL
- en: '![\displaystyle \gamma_3=\frac{\mu_3}{\mu_2^{3/2}}, \ \gamma_4 = \frac{\mu_4}{\mu_2^2}-3](img/a8ae17f52bb3b41e4329c9c93bbe14b2.png)'
  prefs: []
  type: TYPE_IMG
- en: Corrado and Su [3] get for an European call option price with third and fourth
    order corrections
  prefs: []
  type: TYPE_NORMAL
- en: '![\begin{array}{rcl} \displaystyle C_{CS}&=&C_{BS}(F_0^t, K, \sigma, r, t)
    +\gamma_3 Q_3 + \gamma_4 Q4 \\ Q_3 &=& \frac{1}{3!}F_0^t\sigma\sqrt{t}\left(2\sigma\sqrt{t}-d)\right)\varphi(d)\\
    Q_4&=& \frac{1}{4!}F_0^t\sigma\sqrt{t}\left(d^2-3d\sigma\sqrt{t}-1\right)\varphi(d)\\
    \varphi(d) &=& \frac{1}{\sqrt{2\pi}}e^{-\frac{d^2}{2}}\\ d &=& \frac{\ln\left(F_0^t/K\right)+\sigma^2
    t/2}{\sigma \sqrt{t}}\\\sigma &=& \sqrt{\mu_2 / t}.\end{array}](img/ca30fe2b70b40005dc853d0050b78fbe.png)'
  prefs: []
  type: TYPE_IMG
- en: whereas in 1998 Rubinstein [4] derived the following approximation considering
    a normal Edgeworth series expansion
  prefs: []
  type: TYPE_NORMAL
- en: '![\begin{array}{rcl} \displaystyle C_R = &=&C_{BS}(F_0^t, K, \sigma, r, t)
    +\gamma_3 Q_3 + \gamma_4 Q4 + \gamma_3^2 Q_5 \\ Q_5&=& \frac{10}{6!}F_0^t\sigma\sqrt{t}\left(d^4-5d^3\sigma\sqrt{t}-6d^2+15d\sigma\sqrt{t}+3\right)\varphi(d).
    \end{array}](img/e7e14f52245b462b79ce1010995dff0a.png)'
  prefs: []
  type: TYPE_IMG
- en: Two regimes are considered to test the quality of the different approximations
    for the Kluge model. First a regime with relatively small jumps but changing jump
    intensity and second a regime with a few jumps but changing jump size. The test
    parameters are
  prefs: []
  type: TYPE_NORMAL
- en: '![F_0=30, K=F_0, t=0.5, X_0=Y_0=0, \\ \alpha=4.0, \sigma=1.0, \beta=5.0, \eta=5.0,
    \lambda=4.0](img/c66d300b03f308b0492775875e2ebbee.png)'
  prefs: []
  type: TYPE_IMG
- en: The reference results for Euopean vanilla calls are generated with the corresponding
    finite difference pricing engine and Richardson extrapolation. First test case
    is to vary the number of jumps by increasing ![\lambda](img/4a42b8a415b6b944138e18b71269a40a.png)
    from zero to 40.![jumpintensity.png](img/810a3a837a35006056667274dfa9885b.png)The
    Corrado/Su fourth order approximation wins only for very small jump intensities,
    whereas for larger jump intensities the Corrado/Su approximation up to third order
    competes head-to-head against the Rubinstein formula. Similar picture can be seen
    for the second test case, few jumps with increasing jump size. For small jumps
    the fourth order approximation takes the lead but for most of the time the Rubinstein
    approximation gives the best results.![jumpsize.png](img/204a8333c5642a615c7daf34a9d23dec.png)
  prefs: []
  type: TYPE_NORMAL
- en: 'Source code for these results can be taken from the [PR #728.](https://github.com/lballabio/QuantLib/pull/728)'
  prefs: []
  type: TYPE_NORMAL
- en: '[1] Kluge, T. : [Pricing Swing Options and other Electricity Derivatives](https://www.semanticscholar.org/paper/Pricing-Swing-Options-and-other-Electricity-Kluge/9e8be93531ffa8aeb1a9e36181e0537cac99e400)'
  prefs: []
  type: TYPE_NORMAL
- en: '[2] Jurczenko, E, Maillet, B and Negrea, B: [Multi-moment Approximate Option
    Pricing](https://papers.ssrn.com/sol3/papers.cfm?abstract_id=300922)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Models: A General Comparison (Part 1)](https://papers.ssrn.com/sol3/papers.cfm?abstract_id=300922)'
  prefs: []
  type: TYPE_NORMAL
- en: '[3]  Corrado C. and T. Su: [Implied Volatility Skews and Stock Return](https://www.researchgate.net/publication/24080621_Implied_volatility_skews_and_stock_return_skewness_and_kurtosis_implied_by_stock_option_prices)'
  prefs: []
  type: TYPE_NORMAL
- en: '[Skewness and Kurtosis Implied by Stock Option Prices](https://www.researchgate.net/publication/24080621_Implied_volatility_skews_and_stock_return_skewness_and_kurtosis_implied_by_stock_option_prices)
    , European Journal of'
  prefs: []
  type: TYPE_NORMAL
- en: Finance 3, 73-85., 1997
  prefs: []
  type: TYPE_NORMAL
- en: '[4] Rubinstein M: [Edgeworth Binomial Trees](https://pdfs.semanticscholar.org/f5d2/d0b90dea9a5e2dc298f0ba0aefc2b98387e4.pdf),
    Journal of Derivatives'
  prefs: []
  type: TYPE_NORMAL
- en: 5 (3), 20-27., 1998
  prefs: []
  type: TYPE_NORMAL
