["```\n\nReturns = mu + e, e ~ N(0, sigma)\n\n```", "```\n\nReturns = mu + e, e ~ N(0, sigma) \nmu = mu.Bull for Bull regime and mu.Bear for Bear regime and\nsigma= sigma.Bull for Bull regime and sigma.Bear for Bear regime\n\n```", "```\n\n###############################################################################\n# Load Systematic Investor Toolbox (SIT)\n# https://systematicinvestor.wordpress.com/systematic-investor-toolbox/\n###############################################################################\nsetInternet2(TRUE)\ncon = gzcon(url('http://www.systematicportfolio.com/sit.gz', 'rb'))\n    source(con)\nclose(con)\n\n\t#*****************************************************************\n\t# Generate data as in the post\n\t#****************************************************************** \n\tbull1 = rnorm( 100, 0.10, 0.15 )\n\tbear  = rnorm( 100, -0.01, 0.20 )\n\tbull2 = rnorm( 100, 0.10, 0.15 )\n\ttrue.states = c(rep(1,100),rep(2,100),rep(1,100))\n\treturns = c( bull1, bear,  bull2 )\n\n\t# find regimes\n\tload.packages('RHmm')\n\n\ty=returns\n\tResFit = HMMFit(y, nStates=2)\n\tVitPath = viterbi(ResFit, y)\n\n\t#Forward-backward procedure, compute probabilities\n\tfb = forwardBackward(ResFit, y)\n\n\t# Plot probabilities and implied states\n\tlayout(1:2)\n\tplot(VitPath$states, type='s', main='Implied States', xlab='', ylab='State')\n\n\tmatplot(fb$Gamma, type='l', main='Smoothed Probabilities', ylab='Probability')\n\t\tlegend(x='topright', c('State1','State2'),  fill=1:2, bty='n')\n\n```", "```\n\n\t#*****************************************************************\n\t# Add some data and see if the model is able to identify the regimes\n\t#****************************************************************** \n\tbear2  = rnorm( 100, -0.01, 0.20 )\n\tbull3 = rnorm( 100, 0.10, 0.10 )\n\tbear3  = rnorm( 100, -0.01, 0.25 )\n\ty = c( bull1, bear,  bull2, bear2, bull3, bear3 )\n\tVitPath = viterbi(ResFit, y)$states\n\n\t#*****************************************************************\n\t# Plot regimes\n\t#****************************************************************** \n\tload.packages('quantmod')\n\tdata = xts(y, as.Date(1:len(y)))\n\n\tlayout(1:3)\n\t\tplota.control$col.x.highlight = col.add.alpha(true.states+1, 150)\n\tplota(data, type='h', plotX=F, x.highlight=T)\n\t\tplota.legend('Returns + True Regimes')\n\tplota(cumprod(1+data/100), type='l', plotX=F, x.highlight=T)\n\t\tplota.legend('Equity + True Regimes')\n\n\t\tplota.control$col.x.highlight = col.add.alpha(VitPath+1, 150)\n\tplota(data, type='h', x.highlight=T)\n\t\tplota.legend('Returns + Detected Regimes')\t\t\t\t\n\n```"]