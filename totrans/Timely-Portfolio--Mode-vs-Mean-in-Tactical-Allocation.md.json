["```\nrequire(quantmod)\nrequire(modeest)\nrequire(PerformanceAnalytics)   start = \"1990-12-31\"\nend = Sys.Date()   #use Vanguard funds as proxy for asset classes\n#due to Vanguard fees for early redemption\n#these funds not appropriate for Tactical system\ntckrs <- c(\"VFINX\",\"VEIEX\",\"VGSTX\",\"VBMFX\")\ngetSymbols(tckrs, from=start, to=end, adjust=TRUE)\nfor (i in 1:length(tckrs)) {\n\tassign(tckrs[i],to.monthly(get(tckrs[i]))[,4])\n}   funds <- na.omit(merge(VFINX[,1],VEIEX[,1],VGSTX[,1],VBMFX[,1]))\n#get dates to include day so format is YYYY-MM-DD\nindex(funds) <- as.Date(index(funds))\ncolnames(funds) <- tckrs   #get 1 month change\nfunds.roc <- ROC(funds,type=\"discrete\",n=1)\n#add a balanced benchmark\n#20% of each equity fund for 60% total equities\n#40% of US bonds\nfunds.roc <- merge(funds.roc,\n\t0.2*funds.roc[,1]+0.2*funds.roc[,2]+0.2*funds.roc[,3]+0.4*funds.roc[,4])\nfunds.roc[1,5] <- 0\ncolnames(funds.roc) <- c(colnames(funds),\"Balanced\")   #combine all the funds into one xts\nfunds <- merge(funds,cumprod(1+funds.roc[,5]))\n#charts.PerformanceSummary(funds.roc,\n#\tmain=\"Vanguard Funds for US, Emerging, Intl Stocks and US Bonds\n#\twith a 60/40 Balanced Allocation\")   #set width to be 10 months similar to Mebane Faber 10 month moving average\nwidth = 10\n#set up system.signal with same number of columns and rows as funds\nsystem.signal <- funds\n#loop through each column since I could not use apply with mode calculation\nfor (m in 1:NCOL(system.signal)) {\n\t#another for loop to do the rolling mode since it also does not work with apply\n\tfor (n in width:NROW(system.signal[,m])) {\n\t\tmd <- mlv(funds[(n-width):n,m], method = \"lientz\", bw=0.4)\n\t\tifelse(n==width,\n\t\t\tmd.hist <- as.numeric(md[1]),\n\t\t\tmd.hist <- rbind(md.hist,as.numeric(md[1])))\n\t}\n\t#make into nice xts\n\tmd.xts <- as.xts(as.data.frame(md.hist),\n\t\torder.by=index(system.signal[(width):NROW(system.signal)]))\n\t#put rolling modes into system.signal\n\tsystem.signal[(width):NROW(system.signal),m] <- md.hist\n}   #jpeg(filename=\"mode chart.jpg\",\n#\tquality=100,width=6.25, height = 6.25,  units=\"in\",res=96)\nplot.zoo(system.signal,main=\"Modes (lientz) of Funds\",nc=1,\n\tcol=c(\"gray70\",\"steelblue4\",\"darkolivegreen4\",\"goldenrod\",\"purple\"))\n#dev.off()   #difficult way to get 1 for in and 0 for out\n#but the ifelse gave me an index increasing order error\n#will use apply instead\nsystem.signal <- funds > system.signal\nsystem.signal[,1:length(tckrs)] <- apply(system.signal[,1:length(tckrs)],MARGIN=2,FUN=as.numeric)\nret.signal <- lag(system.signal,k=1) * funds.roc[,1:5]\nret.compare <- merge(funds.roc[,4],\n\t0.2*ret.signal[,1]+0.2*ret.signal[,2]+0.2*ret.signal[,3]+0.4*ret.signal[,4],\n\tret.signal[,5],\n\tfunds.roc[,5])\ncolnames(ret.compare) <- c(\"VBMFX.Bonds\",\"ModeSystem\",\"ModeOnBalanced\",\"Balanced\")   #jpeg(filename=\"signal chart.jpg\",\n#\tquality=100,width=6.25, height = 6.25,  units=\"in\",res=96)\nplot.zoo(system.signal,main=\"Signals (hsm) of Funds\",nc=1,\n\tcol=c(\"gray70\",\"steelblue4\",\"darkolivegreen4\",\"goldenrod\",\"purple\"))\n#dev.off()   #jpeg(filename=\"performance summary no average.jpg\",\n#\tquality=100,width=6.25, height = 6.25,  units=\"in\",res=96)\ncharts.PerformanceSummary(ret.compare,ylog=TRUE,\n\tmain=\"Performance of Tactical Approaches\n\twith Balanced Benchmark\",\n\tcolorset=c(\"gray70\",\"steelblue4\",\"darkolivegreen4\",\"goldenrod\",\"purple\"),\n\tcex.legend=1.2,lwd=2)\n#dev.off()     #now let's compare to Mebane Faber 10-month moving average strategy\n#will do in 1 line since there are multiple examples of how\n#to implement this in R\nret.average <- lag(as.xts(apply(\n\tfunds > apply(funds[,1:5],MARGIN=2,FUN=runMean,10),MARGIN=2,as.numeric),order.by=index(funds)),k=1) * funds.roc\nret.compare <- merge(ret.compare,\n\t0.2*ret.average[,1]+0.2*ret.average[,2]+0.2*ret.average[,3]+0.4*ret.average[,4])\ncolnames(ret.compare) <- c(colnames(ret.compare)[1:(NCOL(ret.compare)-1)],\"Faber10moAvg\")   #jpeg(filename=\"performance summary with Faber average.jpg\",\n#\tquality=100,width=6.25, height = 6.25,  units=\"in\",res=96)\ncharts.PerformanceSummary(ret.compare,ylog=TRUE,\n\tmain=\"Performance of Tactical Approaches\n\twith Balanced Benchmark and Mebane Faber 10mo Mov Avg\",\n\tcolorset=c(\"gray70\",\"steelblue4\",\"darkolivegreen4\",\"goldenrod\",\"purple\"),\n\tcex.legend=1.2,lwd=2)\n#dev.off()\n```"]