["```\n#---------------------------------------------------------------------------------------------\n#| Comparing different copula;\n#| Showing why empirical correlation will be risky if your assumption\n#| of the join distribution (ex: Multi normal vs. t) is not correct.\n#|\n#| Created by: Nan Zhou\n#| Time: 2012-03-05\n#---------------------------------------------------------------------------------------------\nrm(list=ls())\n#memory.size(max=4000)\nrequire(copula)\nn = 1000 # number of simulation of random sample\np =0.95 # quantile line for the plot\ndf = 1 # d.f. of marginal distribution of t\nrho = 0.75 # empirical correlation\ndist.margin = \"norm\" # Marginal distribution\n#---------------------------------------------------------------------------------------------\n\n#Normal Marginal\n\nmvd.gaussian <- mvdc(copula = ellipCopula(family = \"normal\", param = rho),\n                     margins = rep(dist.margin,2),\n                     paramMargins = list(list(mean = 0,sd = 1), list(mean = 0, sd = 1)))\n\nmyMvd2 <- mvdc(copula = ellipCopula(family = \"t\", param = rho, df = df),\n                margins = rep(dist.margin,2),\n                paramMargins = list(list(mean = 0,sd = 1), list(mean = 0, sd = 1)))\n\n#windows ( width = 150, height = 200)\n#layout(matrix(c(1,2,3,3),ncol=2,byrow=TRUE),heights=c(1,2))\n\npar(mfrow=c(3,2))\ncontour(mvd.gaussian, dmvdc, xlim = c(-3, 3), ylim = c(-3, 3))\ntitle(paste(\"Gaussian Copula, Margin Dist =\", dist.margin, \", rho =\", rho, \", df =\",df),\n        cex.main=.8)\ncontour(myMvd2, dmvdc, xlim = c(-3, 3), ylim = c(-3, 3))\ntitle(paste(\"t Copula, Margin Dist =\", dist.margin, \", rho =\", rho, \", df =\",df),\n        cex.main=.8)\n\nfor (rho in c(0.75,0.25))\nfor (df in c(1,5))\n{\n    seed = 1\n    lim.plot = c(-3,3)\n    u <- rcopula(normalCopula(param = rho, dim = 2), n)\n    v <- rcopula(tCopula(param = rho, dim = 2, df = df), n)\n    plot(qnorm(u),xlab='x1',ylab='x2',col='blue',cex=0.6,xlim=lim.plot,ylim=lim.plot)\n    title(paste(\"rho=\",rho,\"df=\",df))\n    points(qnorm(v),xlab='x1',ylab='x2',col='red',cex=0.6)\n    q = qnorm(p)\n    abline(v = q)\n    abline(h = q)\n    text(-2,q,paste(p*100,\"% quantile\"))\n}\n```"]