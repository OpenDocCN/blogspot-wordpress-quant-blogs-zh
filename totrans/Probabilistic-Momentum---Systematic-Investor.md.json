["```\n\n###############################################################################\n# Load Systematic Investor Toolbox (SIT)\n# https://systematicinvestor.wordpress.com/systematic-investor-toolbox/\n###############################################################################\nsetInternet2(TRUE)\ncon = gzcon(url('http://www.systematicportfolio.com/sit.gz', 'rb'))\n    source(con)\nclose(con)\n\t#*****************************************************************\n\t# Load historical data\n\t#****************************************************************** \n\tload.packages('quantmod')\n\n\ttickers = spl('SPY,TLT')\n\n\tdata <- new.env()\n\tgetSymbols(tickers, src = 'yahoo', from = '1980-01-01', env = data, auto.assign = T)\n\t\tfor(i in ls(data)) data[[i]] = adjustOHLC(data[[i]], use.Adjusted=T)\n\tbt.prep(data, align='remove.na', dates='2005::')\n\n\t#*****************************************************************\n\t# Setup\n\t#****************************************************************** \n\tlookback.len = 60\n\n\tprices = data$prices\n\n\tmodels = list()\n\n\t#*****************************************************************\n\t# Simple Momentum\n\t#****************************************************************** \n\tmomentum = prices / mlag(prices, lookback.len)\n\tdata$weight[] = NA\n\t\tdata$weight$SPY[] = momentum$SPY > momentum$TLT\n\t\tdata$weight$TLT[] = momentum$SPY <= momentum$TLT\n\tmodels$Simple  = bt.run.share(data, clean.signal=T) \t\n\n```", "```\n\n\t#*****************************************************************\n\t# Probabilistic Momentum\n\t#****************************************************************** \n\tconfidence.level = 60/100\n\tret = prices / mlag(prices) - 1 \n\n\tir = sqrt(lookback.len) * runMean(ret$SPY - ret$TLT, lookback.len) / runSD(ret$SPY - ret$TLT, lookback.len)\n\tmomentum.p = pt(ir, lookback.len - 1)\n\n\tdata$weight[] = NA\n\t\tdata$weight$SPY[] = iif(cross.up(momentum.p, confidence.level), 1, iif(cross.dn(momentum.p, (1 - confidence.level)), 0,NA))\n\t\tdata$weight$TLT[] = iif(cross.dn(momentum.p, (1 - confidence.level)), 1, iif(cross.up(momentum.p, confidence.level), 0,NA))\n\tmodels$Probabilistic  = bt.run.share(data, clean.signal=T) \t\n\n```", "```\n\n\t#*****************************************************************\n\t# Probabilistic Momentum + SPY Leverage \n\t#****************************************************************** \n\tdata$weight[] = NA\n\t\tdata$weight$SPY[] = iif(cross.up(momentum.p, confidence.level), 1, iif(cross.up(momentum.p, (1 - confidence.level)), 0,NA))\n\t\tdata$weight$TLT[] = iif(cross.dn(momentum.p, (1 - confidence.level)), 1, iif(cross.up(momentum.p, confidence.level), 0,NA))\n\tmodels$Probabilistic.Leverage = bt.run.share(data, clean.signal=T) \t\n\n\t#*****************************************************************\n\t# Create Report\n\t#******************************************************************    \n\tstrategy.performance.snapshoot(models, T)\n\n```", "```\n\n\t#*****************************************************************\n\t# Visualize Signal\n\t#******************************************************************        \n\tcols = spl('steelblue1,steelblue')\n\tprices = scale.one(data$prices)\n\n\tlayout(1:3)\n\n\tplota(prices$SPY, type='l', ylim=range(prices), plotX=F, col=cols[1], lwd=2)\n\tplota.lines(prices$TLT, type='l', plotX=F, col=cols[2], lwd=2)\n\t\tplota.legend('SPY,TLT',cols,as.list(prices))\n\n\thighlight = models$Probabilistic$weight$SPY > 0\n\t\tplota.control$col.x.highlight = iif(highlight, cols[1], cols[2])\n\tplota(models$Probabilistic$equity, type='l', plotX=F, x.highlight = highlight | T)\n\t\tplota.legend('Probabilistic,SPY,TLT',c('black',cols))\n\n\thighlight = models$Simple$weight$SPY > 0\n\t\tplota.control$col.x.highlight = iif(highlight, cols[1], cols[2])\n\tplota(models$Simple$equity, type='l', plotX=T, x.highlight = highlight | T)\n\t\tplota.legend('Simple,SPY,TLT',c('black',cols))\t\n\n```"]