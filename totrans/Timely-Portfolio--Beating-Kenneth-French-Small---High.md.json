["```\n#the real challenge now is how to beat the best\n#small momentum with a system\n#get very helpful Ken French data\n#for this project we will look at Momentum Portfolios\n#http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/ftp/6_Portfolios_ME_Prior_12_2.zip   require(PerformanceAnalytics)\nrequire(quantmod)\nrequire(ggplot2)   my.url=\"http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/ftp/6_Portfolios_ME_Prior_12_2.zip\"\nmy.tempfile<-paste(tempdir(),\"\\\\frenchmomentum.zip\",sep=\"\")\nmy.usefile<-paste(tempdir(),\"\\\\6_Portfolios_ME_Prior_12_2.txt\",sep=\"\")\ndownload.file(my.url, my.tempfile, method=\"auto\", \n\tquiet = FALSE, mode = \"wb\",cacheOK = TRUE)\nunzip(my.tempfile,exdir=tempdir(),junkpath=TRUE)\n#read space delimited text file extracted from zip\nfrench_momentum <- read.table(file=my.usefile,\n\theader = TRUE, sep = \"\",\n\tas.is = TRUE,\n\tskip = 12, nrows=1013)\ncolnames(french_momentum) <- c(paste(\"Small\",\n\tcolnames(french_momentum)[1:3],sep=\".\"),\n\tpaste(\"Large\",colnames(french_momentum)[1:3],sep=\".\"))   #get dates ready for xts index\ndatestoformat <- rownames(french_momentum)\ndatestoformat <- paste(substr(datestoformat,1,4),\n\tsubstr(datestoformat,5,7),\"01\",sep=\"-\")   #get xts for analysis\nfrench_momentum_xts <- as.xts(french_momentum[,1:6],\n\torder.by=as.Date(datestoformat))   french_momentum_xts <- french_momentum_xts/100   charts.PerformanceSummary(french_momentum_xts[,1:3],ylog=TRUE,\n\tmain=\"Performance by Kenneth French Size and Momentum\n\tMonthly Since 1927\",\n\tcolorset=c(\"cadetblue3\",\"cadetblue\",\"cadetblue4\",\n\t\"darkolivegreen3\",\"darkolivegreen\",\"darkolivegreen4\"))\nmtext(\"Source: http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html\",\n\tside=1,adj=0,cex=0.75)\n#dev.off()     #get price series of small cap high momentum for system building\nfrench_momentum_price <- cumprod(1+french_momentum_xts[,3])   #speedy solution for ranking from Charles Berry\n# http://r.789695.n4.nabble.com/efficient-rolling-rank-td2013535.html\n#rolling rank of price over last 12 months (12 means max price for last 12)\n#pad first 11 with NA\nnper <- 10\nx.rank <- c(rep(NA,nper-1),rowSums(coredata(french_momentum_price)[ -(1:(nper-1)) ] >= embed(french_momentum_price,nper)))\nx.rank <- as.xts(x.rank,order.by=index(french_momentum_price))\nsignalRank <- ifelse(x.rank[,1] > 3 | \n\tfrench_momentum_price >= runMax(french_momentum_price,2),1,0)\nretRank <- lag(signalRank,k=1)*french_momentum_xts[,3]   #try rolling 10 month moving average popularized by Mebane Faber\nsignalAvg <- ifelse(french_momentum_price > runMean(french_momentum_price,n=10),1,0)\nretAvg <- lag(signalAvg,k=1)*french_momentum_xts[,3]   #try RSI\nsignalRSI <- ifelse(RSI(french_momentum_price,n=4) > 45,1,0)\nretRSI <- lag(signalRSI,k=1)*french_momentum_xts[,3]   retCompare <- merge(retRank,retAvg,retRSI,french_momentum_xts[,3])\ncolnames(retCompare) <- c(\"Small.High.Rank\",\n\t\"Small.High.Avg\",\"Small.High.RSI\",\"Small.High.Benchmark\")\n#jpeg(filename=\"performance of small-high with systems.jpg\",quality=100,width=6.25, height = 8,  units=\"in\",res=96)\ncharts.PerformanceSummary(retCompare,ylog=TRUE,cex.legend=1.2,\n\tcolorset = c(\"cadetblue\",\"darkolivegreen3\",\"purple\",\"gray70\"),\n\tmain=\"Kenneth French Small Size and High Momentum Stocks\n\tCompared To Various Price Systems\")\n#dev.off()   #jpeg(filename=\"capture of small-high with systems.jpg\",quality=100,width=6.25, height = 8,  units=\"in\",res=96)\nchart.CaptureRatios(retCompare[,1:3],retCompare[,4],\n\tmain=\"Kenneth French Small Size and High Momentum Stocks\n\tCompared To Various Price Systems\")\n#dev.off()   #get average of small size for additional system testing\nfrench_momentum_avg <- cumprod(1+apply(coredata(french_momentum_xts[,c(1:3)]),MARGIN=1,FUN=mean))\nfrench_momentum_avg <- as.xts(french_momentum_avg,order.by=index(french_momentum_price))\nnper <- 10\nx.rank <- c(rep(NA,nper-1),rowSums(coredata(french_momentum_avg)[ -(1:(nper-1)) ] >= embed(french_momentum_avg,nper)))\nx.rank <- as.xts(x.rank,order.by=index(french_momentum_avg))\nsignalRankAvg <- ifelse(x.rank[,1] > 3 | \n\tfrench_momentum_price >= runMax(french_momentum_price,2),1,0)\nretRankAvg <- lag(signalRankAvg,k=1)*french_momentum_xts[,3]   retCompare <- merge(retRank,retRankAvg,french_momentum_xts[,3])\ncolnames(retCompare) <- c(\"Small.High.Rank\",\n\t\"Small.High.RankOnAvg\",\"Small.High.Benchmark\")\n#jpeg(filename=\"performance of small-high with 2 rank systems.jpg\",quality=100,width=6.25, height = 8,  units=\"in\",res=96)\ncharts.PerformanceSummary(retCompare,ylog=TRUE,cex.legend=1.2,\n\tcolorset = c(\"cadetblue\",\"darkolivegreen3\",\"gray70\"),\n\tmain=\"Kenneth French Small Size and High Momentum Stocks\n\tCompared To Rank-based Price Systems\")\n#dev.off()\n```"]