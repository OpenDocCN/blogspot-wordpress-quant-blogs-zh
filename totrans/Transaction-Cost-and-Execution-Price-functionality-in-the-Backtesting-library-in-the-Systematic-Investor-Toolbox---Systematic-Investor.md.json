["```\n\n###############################################################################\n# Load Systematic Investor Toolbox (SIT)\n# https://systematicinvestor.wordpress.com/systematic-investor-toolbox/\n###############################################################################\ncon = gzcon(url('http://www.systematicportfolio.com/sit.gz', 'rb'))\n    source(con)\nclose(con)\n\n\t#*****************************************************************\n\t# Load historical data\n\t#****************************************************************** \n\tload.packages('quantmod')\t\n\ttickers = spl('SPY')\n\n\tdata <- new.env()\n\tgetSymbols(tickers, src = 'yahoo', from = '1970-01-01', env = data, auto.assign = T)\n\t\tfor(i in ls(data)) data[[i]] = adjustOHLC(data[[i]], use.Adjusted=T)\t\t\t\n\tbt.prep(data, align='keep.all', dates='1970::')\t\n\n\t#*****************************************************************\n\t# Code Strategies\n\t#****************************************************************** \n\tprices = data$prices   \n\tnperiods = nrow(prices)\n\n\tmodels = list()\n\n\t#*****************************************************************\n\t# Buy & Hold\n\t#****************************************************************** \n\tdata$weight[] = 0\n\t\tdata$execution.price[] = NA\n\t\tdata$weight[] = 1\n\tmodels$buy.hold = bt.run.share(data, clean.signal=T)\n\n\t#*****************************************************************\n\t# MA cross-over strategy\n\t#****************************************************************** \n\tsma.fast = SMA(prices, 50)\n\tsma.slow = SMA(prices, 200)\n\t\tsignal = iif(sma.fast >= sma.slow, 1, -1)\n\n\tdata$weight[] = NA\n\t\tdata$weight[] = signal\n\tmodels$ma.crossover = bt.run.share(data, clean.signal=T, trade.summary = TRUE)\n\n\t#*****************************************************************\n\t# MA cross-over strategy, add 10c per share commission\n\t#*****************************************************************\t\n\tdata$weight[] = NA\n\t\tdata$weight[] = signal\n\tmodels$ma.crossover.com = bt.run.share(data, commission = 0.10, clean.signal=T)\n\n```", "```\n\n\t#*****************************************************************\n\t# MA cross-over strategy:\n\t# Exit trades at the close on the day of the signal\n\t# Enter trades at the open the next day after the signal\t\n\t#****************************************************************** \n\tpopen = bt.apply(data, Op)\t\t\n\tsignal.new = signal\n\t\ttrade.start\t = which(signal != mlag(signal) & signal != 0)\n\t\tsignal.new[trade.start] = 0\n\t\ttrade.start = trade.start + 1\n\n\tdata$weight[] = NA\n\t\tdata$execution.price[] = NA\n\t\tdata$execution.price[trade.start,] = popen[trade.start,]\n\t\tdata$weight[] = signal.new\n\tmodels$ma.crossover.enter.next.open = bt.run.share(data, clean.signal=T, trade.summary = TRUE)\t\t\t\n\n\t#*****************************************************************\n\t# Create Report\n\t#****************************************************************** \t\n\t# Plot perfromance\n\tplotbt(models, plotX = T, log = 'y', LeftMargin = 3)\t    \t\n\t\tmtext('Cumulative Performance', side = 2, line = 1)\n\n\t# Plot trades\n\tplotbt.custom.report.part3(models$ma.crossover, trade.summary = TRUE)\t\t\n\tplotbt.custom.report.part3(models$ma.crossover.enter.next.open, trade.summary = TRUE)\t\t\n\n```"]