["```\n\n# Load Systematic Investor Toolbox (SIT)\nsetInternet2(TRUE)\ncon = gzcon(url('https://github.com/systematicinvestor/SIT/raw/master/sit.gz', 'rb'))\n\tsource(con)\nclose(con)\n\n\t#*****************************************************************\n\t# Load historical data\n\t#****************************************************************** \n\tload.packages('quantmod,quadprog,lpSolve')\n\ttickers = spl('SPY,QQQ,EEM,IWM,EFA,TLT,IYR,GLD')\n\n\tdata <- new.env()\n\tgetSymbols(tickers, src = 'yahoo', from = '1980-01-01', env = data, auto.assign = T)\n\t\tfor(i in ls(data)) data[[i]] = adjustOHLC(data[[i]], use.Adjusted=T)\n\n\tdata.weekly <- new.env()\n\t\tfor(i in tickers) data.weekly[[i]] = to.weekly(data[[i]], indexAt='endof')\n\n\tbt.prep(data, align='remove.na', dates='1990::2011')\n\tbt.prep(data.weekly, align='remove.na', dates='1990::2011')\n\n\t#*****************************************************************\n\t# Code Strategies\n\t#****************************************************************** \n\tprices = data$prices   \n\tn = ncol(prices)\n\n\t# find week ends\n\tweek.ends = endpoints(prices, 'weeks')\n\t\tweek.ends = week.ends[week.ends > 0]\t\t\n\n\t# Equal Weight 1/N Benchmark\n\tdata$weight[] = NA\n\t\tdata$weight[week.ends,] = ntop(prices[week.ends,], n)\t\t\n\n\t\tcapital = 100000\n\t\tdata$weight[] = (capital / prices) * data$weight\n\tequal.weight = bt.run(data, type='share')\n\n\t#*****************************************************************\n\t# Create Constraints\n\t#*****************************************************************\n\tconstraints = new.constraints(n, lb = -Inf, ub = +Inf)\n\n\t# SUM x.i = 1\n\tconstraints = add.constraints(rep(1, n), 1, type = '=', constraints)\t\t\n\n\tret = prices / mlag(prices) - 1\n\tweight = coredata(prices)\n\t\tweight[] = NA\n\n\tfor( i in week.ends[week.ends >= (63 + 1)] ) {\n\t\t# one quarter is 63 days\n\t\thist = ret[ (i- 63 +1):i, ]\n\n\t\t# create historical input assumptions\n\t\tia = create.historical.ia(hist, 252)\n\t\t\ts0 = apply(coredata(hist),2,sd)\t\t\n\t\t\tia$cov = cor(coredata(hist), use='complete.obs',method='pearson') * (s0 %*% t(s0))\n\n\t\tweight[i,] = min.risk.portfolio(ia, constraints)\n\t}\n\n\t# Minimum Variance\n\tdata$weight[] = weight\t\t\n\t\tcapital = 100000\n\t\tdata$weight[] = (capital / prices) * data$weight\n\tmin.var.daily = bt.run(data, type='share', capital=capital)\n\n```", "```\n\n\t#*****************************************************************\n\t# Code Strategies: Weekly\n\t#****************************************************************** \t\n\tretw = data.weekly$prices / mlag(data.weekly$prices) - 1\n\tweightw = coredata(prices)\n\t\tweightw[] = NA\n\n\tfor( i in week.ends[week.ends >= (63 + 1)] ) {\t\n\t\t# map\n\t\tj = which(index(ret[i,]) == index(retw))\n\n\t\t# one quarter = 13 weeks\n\t\thist = retw[ (j- 13 +1):j, ]\n\n\t\t# create historical input assumptions\n\t\tia = create.historical.ia(hist, 52)\n\t\t\ts0 = apply(coredata(hist),2,sd)\t\t\n\t\t\tia$cov = cor(coredata(hist), use='complete.obs',method='pearson') * (s0 %*% t(s0))\n\n\t\tweightw[i,] = min.risk.portfolio(ia, constraints)\n\t}\t\n\n\tdata$weight[] = weightw\t\t\n\t\tcapital = 100000\n\t\tdata$weight[] = (capital / prices) * data$weight\n\tmin.var.weekly = bt.run(data, type='share', capital=capital)\n\n\t#*****************************************************************\n\t# Create Report\n\t#****************************************************************** \n\tplotbt.custom.report.part1(min.var.weekly, min.var.daily, equal.weight)\n\n\t# plot Daily and Weekly transition maps\n\tlayout(1:2)\n\tplotbt.transition.map(min.var.daily$weight)\n\t\tlegend('topright', legend = 'min.var.daily', bty = 'n')\n\tplotbt.transition.map(min.var.weekly$weight)\n\t\tlegend('topright', legend = 'min.var.weekly', bty = 'n')\n\n```", "```\n\n    ia$cov = tawny::cov.shrink(hist)\n\n    ```", "```\n\n    ia$cov = cor(coredata(hist), use='complete.obs',method='spearman') * (s0 %*% t(s0))\n\n    ```", "```\n\n    ia$cov = cor(coredata(hist), use='complete.obs',method='kendall') * (s0 %*% t(s0))\n\n    ```"]