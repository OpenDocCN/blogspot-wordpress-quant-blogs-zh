["```\n#look at funds run by Smart Money's \"world's greatest investors\"\n#http://www.smartmoney.com/invest/stocks/bouncing-back-with-the-worlds-greatest-investors-1309909342753/?cid=sm_dailyfinanceRSS\n#then apply a simple moving average system\n#to prove a point about controlling drawdown   require(quantmod)\nrequire(PerformanceAnalytics)   tckr<-c(\"OAKMX\",\"CHTTX\",\"FAIRX\",\"FCNTX\")   start<-\"1990-01-01\"\nend<- format(Sys.Date(),\"%Y-%m-%d\") # yyyy-mm-dd   # Pull tckr index data from Yahoo! Finance\ngetSymbols(tckr, from=start, to=end, adjust=TRUE)   RetToAnalyze<-merge(dailyReturn(OAKMX),dailyReturn(CHTTX),\n dailyReturn(FAIRX), dailyReturn(FCNTX))\ncolnames(RetToAnalyze)<-tckr   #get very helpful Ken French data on Momentum Portfolios\n#to compare to the funds\n#http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/ftp/6_Portfolios_ME_Prior_12_2_Daily.zip   my.url=\"http://mba.tuck.dartmouth.edu/pages/faculty/ken.french/ftp/6_Portfolios_ME_Prior_12_2_Daily.zip\"\nmy.tempfile<-paste(tempdir(),\"\\\\frenchmomentum.zip\",sep=\"\")\nmy.usefile<-paste(tempdir(),\"\\\\6_Portfolios_ME_Prior_12_2_Daily.txt\",sep=\"\")\ndownload.file(my.url, my.tempfile, method=\"auto\", \n quiet = FALSE, mode = \"wb\",cacheOK = TRUE)\nunzip(my.tempfile,exdir=tempdir(),junkpath=TRUE)\n#read space delimited text file extracted from zip\nfrench_momentum <- read.table(file=my.usefile,\n header = TRUE, sep = \"\",\n as.is = TRUE,\n skip = 12, nrows=12061)\ncolnames(french_momentum) <- c(paste(\"Small\",\n colnames(french_momentum)[1:3],sep=\".\"),\n paste(\"Large\",colnames(french_momentum)[1:3],sep=\".\"))   #get dates ready for xts index\ndatestoformat <- rownames(french_momentum)\ndatestoformat <- paste(substr(datestoformat,1,4),\n substr(datestoformat,5,6),substr(datestoformat,7,8),sep=\"-\")   #get xts for analysis\nfrench_momentum_xts <- as.xts(french_momentum[,1:6],\n order.by=as.Date(datestoformat))\n#divide by 100 to get in decimal form\nfrench_momentum_xts <- french_momentum_xts/100   #get column 3 for small momentum and 6 for large momentum\n#to compare with the funds\nRetWithFrench <-merge(RetToAnalyze,french_momentum_xts[,c(3,6)])   #jpeg(filename=\"performance summary of funds.jpg\",quality=100,width=6.25, height = 8,  units=\"in\",res=96)\n#charts.PerformanceSummary(RetWithFrench,ylog=TRUE,\n# main=\"Smart Money World's Greatest Investors???\",\n# colorset=c(\"cadetblue\",\"darkolivegreen3\",\"goldenrod\",\n# \"purple\",\"gray\",\"beige\"))\n#dev.off()   #let's just use a Mebane Faber style 200 day moving average\n#to determine entry and exit\n#for the best performer CHTTX\nsignal <- ifelse(CHTTX[,4]>runMean(CHTTX[,4],200),1,0)\nsignal <- merge(lag(signal,k=1),RetWithFrench[,2])\nretCHTTX <- merge(signal[,1] * signal[,2], signal[,2])\ncolnames(retCHTTX) <- c(\"CHTTXMeanSystem\",\"CHTTX\")\n#jpeg(filename=\"performance summary of chttx and mean system.jpg\",quality=100,width=6.25, height = 8,  units=\"in\",res=96)\ncharts.PerformanceSummary(retCHTTX,ylog=TRUE,\n main=\"Smart Money World's Greatest Investors???\n CHTTX with 200 Day Mean System\",\n colorset=c(\"cadetblue\",\"purple\"))\n#dev.off()   #if the investor is comfortable with 60% drawdown\n#then they should be comfortable with leverage applied\n#to the simple mean system; 2.57 would make them even\n#in terms of max drawdown\n#jpeg(filename=\"worst drawdown of chttx and mean system.jpg\",quality=100,width=6.25, height = 8,  units=\"in\",res=96)\nbarplot(maxDrawdown(retCHTTX), main=\"Worst Drawdown Comparison\",\n ylim=c(0,0.6))\ndev.off()\n#print(maxDrawdown(retCHTTX[,2])/maxDrawdown(retCHTTX[,1]))   #let's see now what it looks like with just 2 times leverage\n#applied to the simple mean system\nretCHTTX <- merge(signal[,1] * signal[,2], signal[,1] * 2 * signal[,2], signal[,2])\ncolnames(retCHTTX) <- c(\"CHTTXMeanSystem\",\"CHTTXMean2xLeverage\",\"CHTTX\")\n#jpeg(filename=\"performance summary of chttx and mean system and leverage.jpg\",quality=100,width=6.25, height = 8,  units=\"in\",res=96)\ncharts.PerformanceSummary(retCHTTX,ylog=TRUE,\n main=\"Smart Money World's Greatest Investors???\n CHTTX with 200 Day Mean System and 2x Leverage\",\n colorset=c(\"cadetblue\",\"darkolivegreen3\",\"purple\"))\n#dev.off()   #check max drawdown\n#now by controlling drawdown we can end up with almost double the money\n#with still less total drawdown\n#jpeg(filename=\"worst drawdown of chttx and mean system with leverage.jpg\",quality=100,width=6.25, height = 8,  units=\"in\",res=96)\nbarplot(maxDrawdown(retCHTTX), main=\"Worst Drawdown Comparison\",\n ylim=c(0,0.6))\n#dev.off()\njpeg(filename=\"cumulative return of chttx and mean system with leverage.jpg\",quality=100,width=6.25, height = 8,  units=\"in\",res=96)\nbarplot(Return.cumulative(retCHTTX), main=\"Cumulative Returns Comparison\",\n ylim=c(0,5))\ndev.off()\nprint(Return.cumulative(retCHTTX[,2])/Return.cumulative(retCHTTX[,3]))\n```"]