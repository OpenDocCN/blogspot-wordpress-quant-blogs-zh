["```\n#do everything twice to compare monthly average to daily    require(RQuantLib)\nrequire(quantmod)\nrequire(PerformanceAnalytics) \nrequire(ggplot2)   getSymbols(\"AAA\",src=\"FRED\") # load Moody's AAA from Fed Fred \ngetSymbols(\"BAA\",src=\"FRED\") # load Moody's BAA from Fed Fred    #Fed monthly series of yields is the monthly average of daily yields\n#set index to yyyy-mm-dd format rather than to.monthly mmm yyy for better merging later\nindex(AAA)<-as.Date(index(AAA))\nindex(BAA)<-as.Date(index(BAA))\nAAApricereturn<-AAA\nBAApricereturn<-BAA   AAApricereturn[1,1]<-0\nBAApricereturn[1,1]<-0\ncolnames(AAApricereturn)<-\"PriceReturn-monthly avg AAA\"\ncolnames(BAApricereturn)<-\"PriceReturn-monthly avg BAA\"\n#use quantlib to price the AAA and BAA bonds from monthly yields\n#AAA and BAA series are 20-30 year bonds so will advance date by 25 years\nfor (i in 1:(NROW(AAA)-1)) {\n  AAApricereturn[i+1,1]<-FixedRateBondPriceByYield(yield=AAA[i+1,1]/100,issueDate=Sys.Date(), \n    maturityDate= advance(\"UnitedStates/GovernmentBond\", Sys.Date(), 25, 3),\n    rates=AAA[i,1]/100,period=2)[1]/100-1\n} \nfor (i in 1:(NROW(BAA)-1)) {\n  BAApricereturn[i+1,1]<-FixedRateBondPriceByYield(yield=BAA[i+1,1]/100,issueDate=Sys.Date(), \n    maturityDate= advance(\"UnitedStates/GovernmentBond\", Sys.Date(), 25, 3),\n    rates=BAA[i,1]/100,period=2)[1]/100-1\n}   #total return will be the price return + yield/12 for one month\nAAAtotalreturn<-AAApricereturn+lag(AAA,k=1)/12/100\ncolnames(AAAtotalreturn)<-\"TotalReturn-monthly avg AAA\" \nBAAtotalreturn<-BAApricereturn+lag(BAA,k=1)/12/100\ncolnames(BAAtotalreturn)<-\"TotalReturn-monthly avg BAA\"   charts.PerformanceSummary(merge(AAApricereturn,AAAtotalreturn,BAApricereturn,BAAtotalreturn),ylog=TRUE,\n\tcolorset=c(\"cadetblue\",\"darkolivegreen3\",\"purple\",\"goldenrod\"),\n\tmain=\"Simulated Returns from Moody's AAA and BAA Yield\")\nmtext(\"Source: Federal Reserve FRED\",side=1,adj=0)   AAA_BAA <- na.omit(merge(AAAtotalreturn,BAAtotalreturn))\n#get df for ggplot\ndf <- as.data.frame(cbind(index(AAA_BAA),coredata(AAA_BAA[,1:2])))\ndf[,1] <- paste(substr(format(as.Date(df[,1]),\"%Y\"),1,3),0,sep=\"\")\ncolnames(df) <- c(\"Decade\",\"AAA\",\"BAA\")\ndfmelt <- melt(df,id.vars=1)\ncolnames(dfmelt) <- c(\"Decade\",\"Moodys_Rating\",\"TotalReturn\")\ndfsum <- ddply(dfmelt, .(Decade,Moodys_Rating), summarise,\n\tmean = mean(TotalReturn),\n\tsd = sd(TotalReturn))\njpeg(filename=\"risk and return by rating.jpg\",quality=100,width=6.25, height = 5, \n units=\"in\",res=96)\nggplot(dfsum, aes(x=sd,y=mean,label=factor(Decade))) + geom_point(aes(colour=Moodys_Rating)) +\n\tgeom_line(aes(x=sd,y=mean,colour=Moodys_Rating)) + geom_text(aes(colour=Moodys_Rating)) +\n\topts(title=\"Risk (sd) and Return (mean) by Moodys Rating since 1919\")\ndev.off()     ####some other experimentation but not part of blog post\ngetSymbols(\"DJTA\",src=\"FRED\")\ngetSymbols(\"DJIA\",src=\"FRED\")\n#convert to monthly and get monthly returns\nDJTA <- ROC(to.monthly(DJTA)[,4],n=1,type=\"discrete\")\nDJIA <- ROC(to.monthly(DJIA)[,4],n=1,type=\"discrete\")\n#set index to yyyy-mm-dd format rather than to.monthly mmm yyy for better merging later\nindex(DJTA)<-as.Date(index(DJTA))\nindex(DJIA)<-as.Date(index(DJIA))   #merge AAA,BAA,DJTA,DJIA\nassetReturns <- na.omit(merge(AAAtotalreturn,BAAtotalreturn,DJTA,DJIA))   charts.PerformanceSummary(assetReturns,ylog=TRUE,\n\tcolorset=c(\"cadetblue\",\"darkolivegreen3\",\"purple\",\"goldenrod\"),\n\tmain=\"DJIA, DJTA, and Simulated Returns from Moody's AAA and BAA Yield\")\nmtext(\"Source: Federal Reserve FRED\",side=1,adj=0)   chart.RiskReturnScatter(assetReturns[\"1950::1959\",])\n```"]