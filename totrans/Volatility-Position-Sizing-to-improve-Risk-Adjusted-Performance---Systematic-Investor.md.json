["```\n\n###############################################################################\n# Load Systematic Investor Toolbox (SIT)\n# https://systematicinvestor.wordpress.com/systematic-investor-toolbox/\n###############################################################################\ncon = gzcon(url('http://www.systematicportfolio.com/sit.gz', 'rb'))\n    source(con)\nclose(con)\n\n\t#*****************************************************************\n\t# Load historical data\n\t#****************************************************************** \n\tload.packages('quantmod')\t\n\ttickers = spl('SPY')\n\n\tdata <- new.env()\n\tgetSymbols(tickers, src = 'yahoo', from = '1970-01-01', env = data, auto.assign = T)\n\t\tfor(i in ls(data)) data[[i]] = adjustOHLC(data[[i]], use.Adjusted=T)\t\t\t\n\tbt.prep(data, align='keep.all', dates='1970::')\t\n\n\t#*****************************************************************\n\t# Code Strategies\n\t#****************************************************************** \n\tprices = data$prices   \n\tnperiods = nrow(prices)\n\n\tmodels = list()\n\n\t#*****************************************************************\n\t# Buy & Hold\n\t#****************************************************************** \n\tdata$weight[] = 0\n\t\tdata$weight[] = 1\n\tmodels$buy.hold = bt.run.share(data, clean.signal=T)\n\n```", "```\n\n\t#*****************************************************************\n\t# Volatility Position Sizing - ATR\n\t#****************************************************************** \n\tatr = bt.apply(data, function(x) ATR(HLC(x),20)[,'atr'])\n\n\t# position size in units = ((porfolio size * % of capital to risk)/(ATR*2)) \n\tdata$weight[] = NA\n\t\tcapital = 100000\n\n\t\t# risk 2% of capital\n\t\tdata$weight[] = (capital * 2/100) / (2 * atr)\n\n\t\t# make sure you are not committing more than 100%\n\t\tmax.allocation = capital / prices\n\t\tdata$weight[] = iif(data$weight > max.allocation, max.allocation,data$weight)\n\n\tmodels$buy.hold.2atr = bt.run(data, type='share', capital=capital)\t\t\t\t\t\n\n\t#*****************************************************************\n\t# Create Report\n\t#****************************************************************** \t\n\tmodels = rev(models)\n\n\tplotbt.custom.report.part1(models)\n\n\tplotbt.custom.report.part2(models)\n\n```"]