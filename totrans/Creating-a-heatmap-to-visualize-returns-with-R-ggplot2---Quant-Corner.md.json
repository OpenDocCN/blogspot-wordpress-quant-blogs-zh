["```\n###################################################\n# Ã‰douard Tallent @ TaGoMa.Tech, November 2013    #\n# QuantCorner @ https://quantcorner.wordpress.com  #\n###################################################\n\n# Create a data object from the file object that actually is an object for the file containing the data\ndata <- read.table(file,sep=',',header=TRUE,na.strings=\"NA\") # Create the data object from file\n\n# Remove rows containing NAs\nrow.has.NA <- apply(data, 1, function(x){any(is.na(x))})\n# sum(row.has.NA)\ndata <- data[!row.has.NA,]\n\n# Create a xts object from the data object\nrequire(xts)                                                            # Load xts\ndata <- as.xts(data[,2], order.by=as.Date(data[,1], format='%d/%m/%Y')) # Create the xts object\n\n# Compute the monthly log return\nrequire('quantmod')                                     # Load quantmod\nret <- monthlyReturn(data, type='log', leading=TRUE)    # Compute the monthly returns\n\n# Create a matrix mat object from ret \nret <- c(NA, NA, NA, ret, NA, NA)                               # The original time series nor starts on a Jan month nor ends on Dec \nmat <- matrix(ret*100, ncol=12, byrow=TRUE, dimnames=NULL)      # Create a R matrix\nyear <- seq(from=1981, to=2013, by=1)                           # Vector containing the years\nmonth <- c('Jan','Feb','Mar', 'Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec')    # Vector containing the year months\ncolnames(mat) <- month  # Give columns names\nrownames(mat) <- year   # Give rows names\n\n# Transform the data in mat into a long series using the melt() function\nrequire(reshape2)           # Load reshape2\nmolten <- melt(mat)         # Transform the series into a long series\n\n# Define the color palette to be used in the hetmap\nLtoM <-colorRampPalette(c('red', 'yellow' ))            # The spectrum of colors for the lowest returns\nMid <- \"snow3\"                                          # Snow3 is the color for the (approximatedly) median value\nMtoH <-colorRampPalette(c('lightgreen', 'darkgreen'))   # The spectrum of colors for the highest values\n\n# Plot the heatmap\nrequire(ggplot2)                                                            # Load ggplot2 \nhm <- ggplot(data=molten, aes(x=factor(Var2, levels=month.abb),\n                y=Var1, fill=value)) + geom_raster()                        # Draw the heatmap using geom_raster()\nhm <- hm + scale_fill_gradient2(low=LtoM(100), mid=Mid, high=MtoH(100))     # Colors, please!\nhm <- hm + labs(fill='Return (%)')                                          # The legend\nhm <- hm + geom_text(aes(label=paste(sprintf(\"%.1f %%\", value))), size=4)   # Write the monthly returns in hte heatmap\nhm <- hm + scale_y_continuous(breaks=1981:2013)                             # Deal with the y-axis\nhm <- hm + xlab(label=NULL) +   ylab(label=NULL)                            # No axis names\nhm <- hm + theme_bw()                                                       # No background grey grid\nhm <- hm + theme(axis.text.x=element_text(size=10, hjust=0, vjust=0.4,\n                angle=90))                                                  # Beautify the x-axis\nhm <- hm + ggtitle(label='Monthly return - 1st nearby London ICE Gasoil futures contract')  # Add a title\n\nprint(hm)                                                                   # Print out the heatmap on the screen\n```"]