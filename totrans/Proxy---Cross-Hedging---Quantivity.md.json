["```\n\nrequire(\"vars\")\nrequire(\"tawny\")\n\nbtcdHedge <- function(p, start=1, interval=4)\n{\n  # Generate hedge using BTCD method, as defined by de Prado [2011].\n  #\n  # Args:\n  #   p: matrix of instrument price data\n  #   start: index into p, which to begin generating hedge\n  #   interval: number of periods used to calibrate hedge\n  #\n  # Returns: BTCD hedge ratio vector\n\n  end <- start+interval\n  pvar <- VAR(p[start:end,], p=1, type=\"none\")\n\n  varfit <- fitted(pvar)\n  B <- cov.shrink(p)        # shrink covariance\n  A <- t(varfit) %*% varfit\n\n  C <- chol(B)\n  CInv <- solve(C)\n  D <- t(CInv) %*% A %*% CInv\n  eigens <- eigen(D)\n  z <- eigens$vectors[,length(eigens$values)]\n  x <- CInv %*% z\n  hedge <- x/x[1]\n\n  # perform sanity check\n  tx <- t(x)\n  num <- tx %*% A %*% x\n  denom <- tx %*% B %*% x\n  check <- num / denom\n  if ((check - eigens$values[length(eigens$values)]) > 0.0001)\n  {\n    message(\"failed sanity check\")\n  }\n\n  return (hedge)\n}\n\n```"]