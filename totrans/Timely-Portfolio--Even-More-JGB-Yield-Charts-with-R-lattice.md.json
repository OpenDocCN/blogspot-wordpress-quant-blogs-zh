["```\np2 <- xyplot(value ~ date | indexname, data = jgb.melt, \n    type = \"l\", layout = c(length(unique(jgb.melt$indexname)), \n        1), panel = function(x, y, ...) {\n        panel.abline(h = c(min(y), max(y)))\n        panel.xyplot(x = x, y = y, ...)\n        panel.text(x = x[length(x)/2], y = max(y), \n            labels = levels(jgb.melt$indexname)[panel.number()], \n            cex = 0.7, pos = 3)\n    }, scales = list(x = list(tck = c(1, 0), alternating = 1), \n        y = list(tck = c(1, 0), lwd = c(0, 1))), strip = FALSE, \n    par.settings = list(axis.line = list(col = 0)), \n    xlab = NULL, ylab = \"Yield\", main = \"JGB Yields by Maturity Since Jan 2012\")\np2 <- p2 + layer(panel.abline(h = pretty(jgb.melt$value), \n    lty = 3))\np2 \n```", "```\n jgb.xts.diff <- jgb.xts[\"2012::\", ] - matrix(rep(jgb.xts[\"2012::\", \n    ][1, ], NROW(jgb.xts[\"2012::\", ])), ncol = NCOL(jgb.xts), \n    byrow = TRUE)\njgb.diff.melt <- xtsMelt(jgb.xts.diff)\njgb.diff.melt$date <- as.Date(jgb.diff.melt$date)\njgb.diff.melt$value <- as.numeric(jgb.diff.melt$value)\njgb.diff.melt$indexname <- factor(jgb.diff.melt$indexname, \n    levels = colnames(jgb.xts))\n\np4 <- xyplot(value ~ date | indexname, data = jgb.diff.melt, \n    type = \"h\")\n\nupdate(p2, ylim = c(min(jgb.diff.melt$value), max(jgb.melt$value) + \n    0.5)) + p4 \n```", "```\n update(p2, ylim = c(min(jgb.diff.melt$value), max(jgb.melt$value) + \n    0.5), par.settings = list(axis.line = list(col = \"gray70\"))) + \n    update(p4, panel = function(x, y, col, ...) {\n        # do color scale from red(negative) to\n        # blue(positive)\n        cc.palette <- colorRampPalette(c(brewer.pal(\"Reds\", \n            n = 9)[7], \"white\", brewer.pal(\"Blues\", \n            n = 9)[7]))\n        cc.levpalette <- cc.palette(20)\n        cc.levels <- level.colors(y, at = do.breaks(c(-0.3, \n            0.3), 20), col.regions = cc.levpalette)\n        panel.xyplot(x = x, y = y, col = cc.levels, \n            ...)\n    }) \n```", "```\n p5 <- horizonplot(value ~ date | indexname, data = jgb.diff.melt, \n    layout = c(1, length(unique(jgb.diff.melt$indexname))), \n    scales = list(x = list(tck = c(1, 0))), xlab = NULL, \n    ylab = NULL)\n\np5 \n```", "```\n update(p2, ylim = c(0, max(jgb.melt$value) + 0.5), \n    panel = panel.xyplot) + p5 + update(p2, ylim = c(0, \n    max(jgb.melt$value))) \n```", "```\n# add alpha to colors\naddalpha <- function(alpha = 180, cols) {\n    rgbcomp <- col2rgb(cols)\n    rgbcomp[4] <- alpha\n    return(rgb(rgbcomp[1], rgbcomp[2], rgbcomp[3], \n        rgbcomp[4], maxColorValue = 255))\n}\n\np3 <- xyplot(value ~ indexname, group = date, data = jgb.melt, \n    type = \"l\", lwd = 2, col = sapply(400/(as.numeric(Sys.Date() - \n        jgb.melt$date) + 1), FUN = addalpha, cols = brewer.pal(\"Blues\", \n        n = 9)[7]), main = \"JGB Yield Curve Evolution Since Jan 2012\")\n\np3 <- update(asTheEconomist(p3), scales = list(x = list(cex = 0.7))) + \n    layer(panel.text(x = length(levels(jgb.melt$indexname)), \n        y = 0.15, label = \"source: Japanese Ministry of Finance\", \n        col = \"gray70\", font = 3, cex = 0.8, adj = 1))\n\n# make point rather than line\nupdate(p3, type = \"p\") \n```", "```\n # make point with just most current curve as line\nupdate(p3, type = \"p\") + xyplot(value ~ indexname, \n    data = jgb.melt[which(jgb.melt$date == max(jgb.melt$date)), \n        ], type = \"l\", col = brewer.pal(\"Blues\", n = 9)[7]) \n```"]