["```\n\n###############################################################################\n# Load Systematic Investor Toolbox (SIT)\n# https://systematicinvestor.wordpress.com/systematic-investor-toolbox/\n###############################################################################\nsetInternet2(TRUE)\ncon = gzcon(url('http://www.systematicportfolio.com/sit.gz', 'rb'))\n    source(con)\nclose(con)\n\n\t#*****************************************************************\n\t# Create Efficient Frontier\n\t#****************************************************************** \t\n\t# create sample historical input assumptions\n\tia = aa.test.create.ia()\n\n\t# create long-only, fully invested efficient frontier\n\tn = ia$n\t\t\n\n\t# 0 <= x.i <= 1\n\tconstraints = new.constraints(n, lb = 0, ub = 1)\n\t\tconstraints = add.constraints(diag(n), type='>=', b=0, constraints)\n\t\tconstraints = add.constraints(diag(n), type='<=', b=1, constraints)\n\n\t# SUM x.i = 1\n\tconstraints = add.constraints(rep(1, n), 1, type = '=', constraints)\t\t\n\n\t# create efficient frontier\n\tef = portopt(ia, constraints, 50, 'Efficient Frontier') \n\n\t#*****************************************************************\n\t# Create Plot\n\t#****************************************************************** \t\n\t# plot efficient frontier\n\tplot.ef(ia, list(ef), transition.map=F)\t \n\n\t# find maximum sharpe portfolio\n\tmax(portfolio.return(ef$weight,ia) /  portfolio.risk(ef$weight,ia))\n\n\t# plot minimum variance portfolio\n\tweight = min.var.portfolio(ia,constraints)\t\n\tpoints(100 * portfolio.risk(weight,ia), 100 * portfolio.return(weight,ia), pch=15, col='red')\n\tportfolio.return(weight,ia) /  portfolio.risk(weight,ia)\n\n\t# plot maximum Sharpe or tangency portfolio\n\tweight = max.sharpe.portfolio()(ia,constraints)\t\n\tpoints(100 * portfolio.risk(weight,ia), 100 * portfolio.return(weight,ia), pch=15, col='orange')\n\tportfolio.return(weight,ia) /  portfolio.risk(weight,ia)\n\n\tplota.legend('Minimum Variance,Maximum Sharpe','red,orange', x='topright')\t\n\n```", "```\n\n\t#*****************************************************************\n\t# Examples of Maximum Sharpe or Tangency portfolios construction\n\t#****************************************************************** \t\n\tweight = max.sharpe.portfolio('long-only')(ia,constraints)\t\n\t\tround(weight,2)\n\t\tround(c(sum(weight[weight<0]), sum(weight[weight>0])),2)\n\n\tweight = max.sharpe.portfolio('long-short')(ia,constraints)\t\t\t\n\t\tround(weight,2)\n\t\tround(c(sum(weight[weight<0]), sum(weight[weight>0])),2)\n\n\tweight = max.sharpe.portfolio('market-neutral')(ia,constraints)\t\t\t\n\t\tround(weight,2)\n\t\tround(c(sum(weight[weight<0]), sum(weight[weight>0])),2)\t\n\n```", "```\n\n\t#*****************************************************************\n\t# Load historical data\n\t#****************************************************************** \n\tload.packages('quantmod')\n\n\ttickers = spl('SPY,EFA,EWJ,EEM,IYR,RWX,IEF,TLT,DBC,GLD')\n\n\tdata <- new.env()\n\tgetSymbols(tickers, src = 'yahoo', from = '1980-01-01', env = data, auto.assign = T)\n\t\tfor(i in ls(data)) data[[i]] = adjustOHLC(data[[i]], use.Adjusted=T)\t\t\t\t\t\t\t\n\tbt.prep(data, align='keep.all', dates='2004:12::')\n\n\t#*****************************************************************\n\t# Code Strategies\n\t#******************************************************************\n\tprices = data$prices  \n\tn = ncol(prices)\n\n\tmodels = list()\n\n \t#*****************************************************************\n\t# Code Strategies\n\t#******************************************************************\n\t# find period ends\n\tperiod.ends = endpoints(prices, 'months')\n        period.ends = period.ends[period.ends > 0]\n\n\tn.mom = 180\n\tn.vol = 60\n\tn.top = 4        \n\tmomentum = prices / mlag(prices, n.mom)  \n\n\tobj = portfolio.allocation.helper(data$prices, period.ends=period.ends,\n\t\tlookback.len = n.vol, universe = ntop(momentum[period.ends,], n.top) > 0,\n\t\tmin.risk.fns = list(EW=equal.weight.portfolio,\n\t\t\t\t\t\tRP=risk.parity.portfolio,\n\t\t\t\t\t\tMV=min.var.portfolio,\n\t\t\t\t\t\tMD=max.div.portfolio,\n\t\t\t\t\t\tMC=min.corr.portfolio,\n\t\t\t\t\t\tMC2=min.corr2.portfolio,\n\t\t\t\t\t\tMCE=min.corr.excel.portfolio,\n\t\t\t\t\t\tMS=max.sharpe.portfolio())\n\t) \n\n\tmodels = create.strategies(obj, data)$models\n\n\t#*****************************************************************\n\t# Create Report\n\t#******************************************************************    \n\tstrategy.performance.snapshoot(models, T)\n\n\tplotbt.custom.report.part2(models$MS)\n\n\t# Plot Portfolio Turnover for each strategy\n\tlayout(1)\n\tbarplot.with.labels(sapply(models, compute.turnover, data), 'Average Annual Portfolio Turnover')\n\n```"]