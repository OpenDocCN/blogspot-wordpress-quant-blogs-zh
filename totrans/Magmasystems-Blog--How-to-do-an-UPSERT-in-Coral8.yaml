- en: <!--yml
  prefs: []
  type: TYPE_NORMAL
- en: 'category: 未分类'
  prefs: []
  type: TYPE_NORMAL
- en: 'date: 2024-05-18 05:03:04'
  prefs: []
  type: TYPE_NORMAL
- en: -->
  prefs: []
  type: TYPE_NORMAL
- en: 'Magmasystems Blog: How to do an UPSERT in Coral8'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 来源：[http://magmasystems.blogspot.com/2008/04/how-to-do-upsert-in-coral8.html#0001-01-01](http://magmasystems.blogspot.com/2008/04/how-to-do-upsert-in-coral8.html#0001-01-01)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Assume that the LastTrades window has the retention policy of KEEP LAST PER
    Symbol.
  prefs: []
  type: TYPE_NORMAL
- en: Here is some code (provided by Mark of Coral8) to do an upsert.
  prefs: []
  type: TYPE_NORMAL
- en: '**INSERT INTO****LastTrades******SELECT** SPC.symbol, SPC.price, **If** LT.volume
    **Is Null Then** 0 **Else** LT.volume **End If****FROM** StreamPriceCorrections
    SPC **Left Outer Join** LastTrades LT **ON** SPC.Symbol = LT.Symbol;'
  prefs: []
  type: TYPE_NORMAL
- en: 'If we need to do an update rather than an upsert, this piece of code works:'
  prefs: []
  type: TYPE_NORMAL
- en: '`**INSERT INTO**'
  prefs: []
  type: TYPE_NORMAL
- en: LastTrades
  prefs: []
  type: TYPE_NORMAL
- en: '**SELECT**'
  prefs: []
  type: TYPE_NORMAL
- en: SPC.symbol,
  prefs: []
  type: TYPE_NORMAL
- en: SPC.price,
  prefs: []
  type: TYPE_NORMAL
- en: LT.volume
  prefs: []
  type: TYPE_NORMAL
- en: '**FROM**'
  prefs: []
  type: TYPE_NORMAL
- en: StreamPriceCorrections SPC, LastTrades LT
  prefs: []
  type: TYPE_NORMAL
- en: '**ON** SPC.Symbol = LT.Symbol;`'
  prefs: []
  type: TYPE_NORMAL
- en: ©2008 Marc Adler - All Rights Reserved**
  prefs: []
  type: TYPE_NORMAL
