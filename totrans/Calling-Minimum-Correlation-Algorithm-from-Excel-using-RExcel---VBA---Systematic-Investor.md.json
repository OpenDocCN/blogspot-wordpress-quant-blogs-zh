["```\n\n###############################################################################\n# Load Systematic Investor Toolbox (SIT)                                       \n# https://systematicinvestor.wordpress.com/systematic-investor-toolbox/         \n###############################################################################\nif(!exists('min.corr.portfolio')) {                                            \n   setInternet2(TRUE)                                                          \n   con = gzcon(url('http://www.systematicportfolio.com/sit.gz', 'rb'))         \n       source(con)                                                             \n   close(con)                                                                  \n}                                                                              \n\n   #*****************************************************************          \n   # Setup                                                                     \n   #*****************************************************************          \n   n = ncol(hist_prices)                                                       \n   hist = na.omit(hist_prices / mlag(hist_prices) - 1)                         \n\n   # create historical input assumptions                                       \n   ia = list()                                                                 \n       ia$n = n                                                                \n       ia$risk = apply(hist, 2, sd)                                            \n       ia$correlation = cor(hist, use='complete.obs', method='pearson')        \n       ia$cov = ia$correlation * (ia$risk %*% t(ia$risk))                      \n\n   # portfolio allocation                                                      \n   weights = min.corr.portfolio(ia, null)                                      \n   dim(weights)=c(1,n)                                                         \n\n```", "```\n\n'Minimum Correlation Algorithm\nPublic Function MinimumCorrelation(ByRef r_values As Range) As Variant\n    ' Start R connection\n    RInterface.StartRServer\n\n    ' Write R code to file\n    create_rcode\n\n    ' Put Historical Asset Prices into R\n    RInterface.PutArray \"hist_prices\", r_values\n\n    ' Executes the commands in filename\n    RInterface.RunRFile r_filename\n\n    ' Get Portfolio Allocation determined by the Minimum Correlation Algorithm into Excel\n    MinimumCorrelation = RInterface.GetArrayToVBA(\"weights\")\nEnd Function\n\n```"]