["```\nrequire(modeest)\nrequire(quantmod)\nrequire(PerformanceAnalytics)   getSymbols(\"^GSPC\",from=\"1896-01-01\",to=Sys.Date())\nGSPC.monthly <- to.monthly(GSPC)[,4]\nindex(GSPC.monthly) <- as.Date(index(GSPC.monthly))   #width will represent number of months for mode\nwidth = 10\nfor (i in width:NROW(GSPC.monthly)) {\n\t#not real proud of this code\n\t#please feel free to comment with improvements\n\tm.default <- mlv(GSPC.monthly[(i-width):i])\n\tm.lientz <- mlv(GSPC.monthly[(i-width):i], method = \"lientz\", bw=0.01)\n\tm.hrm <- mlv(GSPC.monthly[(i-width):i], method = \"hrm\", bw=0.01)\n\tm.hsm <- mlv(GSPC.monthly[(i-width):i], method = \"hsm\",tie.action = \"mean\")\n\tm.grenander <- mlv(GSPC.monthly[(i-width):i], method = \"grenander\", p = 0.5)\n\tm.parzen <- mlv(GSPC.monthly[(i-width):i], method = \"parzen\", kernel = \"gaussian\")\n\tm.tsybakov <- mlv(GSPC.monthly[(i-width):i], method = \"tsybakov\")\n\tm.asselin <- mlv(GSPC.monthly[(i-width):i], method = \"asselin\")\n\tm.vieu <- mlv(GSPC.monthly[(i-width):i], method = \"vieu\")   m.all <- c(as.numeric(m.default[1]), as.numeric(m.lientz[1]),\n\t\tas.numeric(m.hrm[1]), as.numeric(m.hsm[1]), as.numeric(m.grenander[1]),\n\t\tas.numeric(m.parzen[1]), as.numeric(m.tsybakov[1]),\n\t\tas.numeric(m.asselin[1]), as.numeric(m.vieu[1]))\n\tifelse(i==width, m.hist <- m.all, m.hist <- rbind(m.hist,m.all))\n}   m.xts <- as.xts(as.data.frame(m.hist),order.by=index(GSPC.monthly[(width):NROW(GSPC.monthly),]))\nm.xts <- merge(m.xts,runMean(GSPC.monthly,n=10),runMedian(GSPC.monthly,n=10))\ncolnames(m.xts) <- c(\"default\",\"lientz\",\"hrm\",\"hsm\",\"grenander\",\"parzen\",\n\t\"tsybakov\",\"asselin\",\"vieu\",\"mean\",\"median\")\nGSPC.mode <- merge(GSPC.monthly,m.xts)   #there has to be a much cleaner way to accomplish this\nsignal <- GSPC.mode[,2:NCOL(GSPC.mode)]\nret <- GSPC.mode[,2:NCOL(GSPC.mode)]\nfor (i in 1:NCOL(signal)) {\n\tsignal[,i] <- ifelse(GSPC.mode[,1] > GSPC.mode[,i+1],1,0)\n\tret[,i] <- lag(signal[,i],k=1) * ROC(GSPC.mode[,1],type=\"discrete\",n=1)\n}\nret <- merge(ret,\n\tROC(GSPC.mode[,1],type=\"discrete\",n=1))   #jpeg(filename=\"modeest performance summary.jpg\",\n#\tquality=100,width=6.25, height = 6.25,  units=\"in\",res=96)\ncharts.PerformanceSummary(ret,ylog=TRUE,lwd=c(rep(2,9),rep(4,3)),\n\tmain=\"Modeest System Comparison with Mean and Median\")\n#dev.off()   t(table.AnnualizedReturns(ret))   #jpeg(filename=\"modeest risk return.jpg\",\n#\tquality=100,width=6.25, height = 6.25,  units=\"in\",res=96)\nchart.RiskReturnScatter(ret)\n#dev.off()\n```"]