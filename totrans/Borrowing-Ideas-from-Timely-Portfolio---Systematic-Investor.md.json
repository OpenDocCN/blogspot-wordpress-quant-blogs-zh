["```\n\n###############################################################################\n# Load Systematic Investor Toolbox (SIT)\n# https://systematicinvestor.wordpress.com/systematic-investor-toolbox/\n###############################################################################\ncon = gzcon(url('http://www.systematicportfolio.com/sit.gz', 'rb'))\n    source(con)\nclose(con)\n\n\t#*****************************************************************\n\t# Load historical data\n\t#****************************************************************** \n\tload.packages('quantmod')\t\n\ttickers = spl('SPY')\n\n\tdata <- new.env()\n\tgetSymbols(tickers, src = 'yahoo', from = '1970-01-01', env = data, auto.assign = T)\n\t\tfor(i in ls(data)) data[[i]] = adjustOHLC(data[[i]], use.Adjusted=T)\t\t\n\tbt.prep(data, align='keep.all', dates='2000::2011')\n\n\t#*****************************************************************\n\t# Code Strategies\n\t#****************************************************************** \n\tprices = data$prices    \n\n\t# Buy & Hold\t\n\tdata$weight[] = 1\n\tbuy.hold = bt.run(data)\t\n\n\t# Strategy\n\tma10 = bt.apply.matrix(prices, EMA, 10)\n\tma50 = bt.apply.matrix(prices, EMA, 50)\n\tma200 = bt.apply.matrix(prices, EMA, 200)\n\tdata$weight[] = NA;\n\t\tdata$weight[] = iif(ma10 > ma50 & ma50 > ma200, 1, \n\t\t\t\tiif(ma10 < ma50 & ma50 < ma200, -1, 0))\n\tstrategy = bt.run.share(data, clean.signal=F)\t\n\n\t#*****************************************************************\n\t# Visualization of system Entry and Exit based on\n\t# http://timelyportfolio.blogspot.ca/2011/08/lm-system-on-nikkei-with-new-chart.html\n\t#****************************************************************** \t\n\tlayout(1)\n\tplota(strategy$eq, type='l', ylim=range(buy.hold$eq,strategy$eq))\n\n\tcol = iif(strategy$weight > 0, 'green', iif(strategy$weight < 0, 'red', 'gray'))\n\tplota.lines(buy.hold$eq, type='l', col=col)\t\t\t\n\t\tplota.legend('strategy,Long,Short,Not Invested','black,green,red,gray')\t\t\n\n```", "```\n\n\t#*****************************************************************\t\n\t# Drawdown Visualization \n\t# 10% drawdowns in yellow and 15% drawdowns in orange\n\t# http://timelyportfolio.blogspot.ca/2011/08/drawdown-visualization.html\n\t#*****************************************************************\t\n\tlayout(1:2)\n\tdrawdowns = compute.drawdown(strategy$eq)\n\thighlight = drawdowns < -0.1\n\n\tplota.control$col.x.highlight = iif(drawdowns < -0.15, 'orange', iif(drawdowns < -0.1, 'yellow', 0))\t\n\n\tplota(strategy$eq, type='l', plotX=F, x.highlight = highlight, ylim=range(buy.hold$eq,strategy$eq))\n\t\tplota.legend('strategy,10% Drawdown,15%  Drawdown','black,yellow,orange')\n\n\tplota(100*drawdowns, type='l', x.highlight = highlight)\n\t\tplota.legend('drawdown', 'black', x='bottomleft')\n\n```", "```\n\n\t#*****************************************************************\n\t# Create Report\n\t#****************************************************************** \t\t\n\tplota.control$col.x.highlight = iif(drawdowns < -0.15, 'orange', iif(drawdowns < -0.1, 'yellow', 0))\t\t\t\t\n\thighlight = drawdowns < -0.1\n\n\tplotbt.custom.report.part1(strategy, buy.hold, x.highlight = highlight)\n\n```"]