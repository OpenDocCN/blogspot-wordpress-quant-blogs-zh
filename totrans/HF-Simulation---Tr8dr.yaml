- en: <!--yml
  prefs: []
  type: TYPE_NORMAL
- en: 'category: 未分类'
  prefs: []
  type: TYPE_NORMAL
- en: 'date: 2024-05-18 15:30:39'
  prefs: []
  type: TYPE_NORMAL
- en: -->
  prefs: []
  type: TYPE_NORMAL
- en: HF Simulation | Tr8dr
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 来源：[https://tr8dr.wordpress.com/2011/02/05/hf-simulation/#0001-01-01](https://tr8dr.wordpress.com/2011/02/05/hf-simulation/#0001-01-01)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Simulation for high-frequency strategies is, at best, a decent way to take one’s
    strategy through its paces, perhaps giving a view on profitability.   In no way
    can it present an accurate view on profitability, rather at best can look at the
    strategy’s performance under various synthetic assumptions.
  prefs: []
  type: TYPE_NORMAL
- en: 'Naturally our simulator must reflect:'
  prefs: []
  type: TYPE_NORMAL
- en: typical order event latency (perhaps with some jitter)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: typical market event latency
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: accurate orderbook
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: view on trade fills
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: view on impact (icing on the cake, perhaps not necessary)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The Data
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'There is just not enough information presented in market data to model with
    complete accuracy nor can we predict with certainty, the effects of our own trades
    on subsequent market events.   With access to a HF feed, we receive events such
    as:'
  prefs: []
  type: TYPE_NORMAL
- en: '[![](img/e31bcd48dc240928d32434fc87bb1749.png "Screen shot 2011-02-05 at 11.40.51
    AM")](https://tr8dr.wordpress.com/wp-content/uploads/2011/02/screen-shot-2011-02-05-at-11-40-51-am.png)'
  prefs: []
  type: TYPE_NORMAL
- en: 'We are able to see most individual order activity.  Primarily, the operations
    are New, Update, and Delete order.    The exceptions are:'
  prefs: []
  type: TYPE_NORMAL
- en: hidden orders
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: orders that immediately cross
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: IOC orders (immediate or cancel)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: What is shown or not shown may vary from venue to venue.   With the above we
    can reconstruct the orderbook as a set of price levels on the bid and another
    set on the ask.  Each price-level represents a queue of orders against which executions
    will occur on a FIFO basis.
  prefs: []
  type: TYPE_NORMAL
- en: 'The orderbook (abbreviated) might look something like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[![](img/1fccf63705a02d3d6527f3af1503b3ae.png "Screen shot 2011-02-05 at 12.29.37
    PM")](https://tr8dr.wordpress.com/wp-content/uploads/2011/02/screen-shot-2011-02-05-at-12-29-37-pm.png)'
  prefs: []
  type: TYPE_NORMAL
- en: 'A simulator using historical data needs to reconstruct the orderbook, maintaining
    proper FIFO behavior.   The two biggest problems in simulation are:'
  prefs: []
  type: TYPE_NORMAL
- en: determining when / if a trade happened
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: determining market impact of strategy trades on historical data
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: With the various FX venues trades are shown selectively, and at that, with significant
    lag to the actual event.   Order (New or Update) events that would have crossed
    are also not shown.   This leaves us to guess when a trade is likely to have happened.
      We can execute our strategy under various scenarios of trade fill.
  prefs: []
  type: TYPE_NORMAL
- en: Possible Trade Events
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Let’s look at some possible signals that a trade may have occurred:'
  prefs: []
  type: TYPE_NORMAL
- en: all orders on our level are removed
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: due to trade or cancellation?
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: inside order level(s) removed
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: due to trade(s) or cancellation?
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: one of the above + our level has moved within epsilon of crossing
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: our level is now crossing
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: None of these except (4) can indicate a trade with certainty, however without
    some assumptions about the first three scenarios would only leave us with aggressive
    crossing or waiting for price levels to collide.
  prefs: []
  type: TYPE_NORMAL
- en: All orders on our level removed
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Consider the above orderbook and the transformed below (where the removed orders
    are in red):'
  prefs: []
  type: TYPE_NORMAL
- en: '[![](img/8856f28b890eb71e1bda5cc860a4d63e.png "Screen shot 2011-02-05 at 1.06.37
    PM")](https://tr8dr.wordpress.com/wp-content/uploads/2011/02/screen-shot-2011-02-05-at-1-06-37-pm.png)'
  prefs: []
  type: TYPE_NORMAL
- en: 'All orders on our orderlevel of 82.709 on the ask have been removed in the
    historical events (except our synthetic order from the strategy we are testing).
      The likelihood that a trade happened is higher if the # of orders on the level
    and/or the maximum size historically for the life of the level is high.   With
    one order on the level removed it may well have been a cancellation.'
  prefs: []
  type: TYPE_NORMAL
- en: In this particular case we see the order on our level and the first order on
    the next level removed.   This strengthens a view that a trade may have occurred.
  prefs: []
  type: TYPE_NORMAL
- en: We can assign a probability of trade based on evidence like this (though if
    using a random / probability approach, ones results will differ with every run).
  prefs: []
  type: TYPE_NORMAL
- en: Deeper Inside Level removed
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Consider the orderbook below:'
  prefs: []
  type: TYPE_NORMAL
- en: '[![](img/37215328fabba5a6955dd7d5e9e642da.png "Screen shot 2011-02-05 at 1.17.00
    PM")](https://tr8dr.wordpress.com/wp-content/uploads/2011/02/screen-shot-2011-02-05-at-1-17-00-pm.png)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Our order is on the inside level and the level(s) above it is either cancelled
    or taken out.  This is an even stronger indication of trade if more than one level
    taken out.   Levels can disappear quickly from a number of possible stimuli:'
  prefs: []
  type: TYPE_NORMAL
- en: 'traded: large buying algorithm buys in size (this happens quite often during
    the day)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'moved: level primarily lead by market makers and activity elsewhere demands
    changing the offering'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'risk aversion: pending event or volatility cause pullback'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '#2 is harder to gauge perhaps, but #1 and #3 are relatively easy to see in
    retrospect.'
  prefs: []
  type: TYPE_NORMAL
- en: Order Moves Close to Crossing
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We may have a passive order that drifts towards crossing (or is placed very
    close to crossing):'
  prefs: []
  type: TYPE_NORMAL
- en: '[![](img/da72f1ecbb5148f09f4e3a74c4baf1c8.png "Screen shot 2011-02-05 at 1.28.03
    PM")](https://tr8dr.wordpress.com/wp-content/uploads/2011/02/screen-shot-2011-02-05-at-1-28-03-pm.png)'
  prefs: []
  type: TYPE_NORMAL
- en: We see that our order is 2/10ths pips away from the cross.  On some venues there
    may be inside-of-inside hidden orders (for venues that don’t require partial exposure
    of size).  In those cases, a move that tight is likely to get executed right away.
      Market makers with inventory may find a cross of 2/10ths appealing as well.
  prefs: []
  type: TYPE_NORMAL
- en: Other Trade Signals?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We did not look at what was happening on the other side of the book, but could
    possibly correlate activity on the other side and activity in the above scenarios
    to determine a stronger likelihood of a trade.   I’d appreciate ideas.
  prefs: []
  type: TYPE_NORMAL
