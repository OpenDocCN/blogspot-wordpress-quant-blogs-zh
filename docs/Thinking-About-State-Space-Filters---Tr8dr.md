<!--yml

类别：未分类

日期：2024-05-18 15:29:58

-->

# 思考状态空间滤波器 | Tr8dr

> 来源：[`tr8dr.wordpress.com/2011/07/27/thinking-about-state-space-filters/#0001-01-01`](https://tr8dr.wordpress.com/2011/07/27/thinking-about-state-space-filters/#0001-01-01)

我已经有几年没有使用过基于随机状态的系统了，但是决定重新审视。我之前实现过多种系统，既有 EKF 也有 3 种粒子滤波器的变体，但遇到了各种问题。

特别是，发现通过协方差矩阵参数化演变对于某些系统是不透明且具有问题的。另外，如果状态分布的平均值或观测样本显著变化，EKF 和粒子滤波器都可能受到数值不稳定的影响， likelihoods 接近 0。

我决定重新审视状态空间滤波器，但采用不同的滤波方法，以便为多区域定价提出不同的方法。

我将从简介开始。传统的状态空间模型是一个离散（或离散化的连续）系统，由测量方程和状态演变方程表示：

![Screen shot 2011-07-27 at 7.01.57 PM](https://tr8dr.wordpress.com/wp-content/uploads/2011/07/screen-shot-2011-07-27-at-7-01-57-pm.png)

在哪里：

1.  X 是一个 n 维向量，表示系统在时间步长 t 上的状态

1.  Y 是一个 m 维向量，表示时间步长 t 上的测量值（例如我们价格序列中的一个价格）

1.  f(.) 是我们状态演变函数，将 t-1 状态映射到 t 状态

1.  g(.) 是我们的状态到测量的映射

1.  ε_x 我们的状态噪声/误差 ~ N (0, Σx)

1.  ε_y 我们的观测噪声/误差 ~ N(0,Σy)

**卡尔曼滤波器家族** 卡尔曼滤波器家族使用贝叶斯逻辑实现线性误差修正模型，从而使估计的 Yt 误差传播回演变状态 Xt（或者更精确地说，Xt 的演变分布）。

传统的卡尔曼滤波器假设一个线性函数 f(.) 和 g(.)，通常表示为矩阵：

![Screen shot 2011-07-27 at 7.30.55 PM](https://tr8dr.wordpress.com/wp-content/uploads/2011/07/screen-shot-2011-07-27-at-7-30-55-pm.png)

我们感兴趣的是在给定噪声观测数据 Yt 的情况下估计状态 Xt，因此我们感兴趣的是概率密度函数 **p(x[t] | y[1:t])**。考虑到我们将通过滤波器中的递归 inherent in filtering 获得对 pdf 的滞后（t-1）视图，我们首先需要能够计算 **p(x[t] | y[1:t-1])**，然后使用那个 **p(x[t] | y[1:t])**:

![Screen shot 2011-07-27 at 8.28.48 PM](https://tr8dr.wordpress.com/wp-content/uploads/2011/07/screen-shot-2011-07-27-at-8-28-48-pm.png)

因此，如 Hartikainen 2008 年所指出，上述线性状态方程映射到分布：

![屏幕快照 2011-07-27](https://tr8dr.wordpress.com/wp-content/uploads/2011/07/screen-shot-2011-07-27-at-8-37-51-pm.png)【图片无法显示，如需翻译图片上的文字，请提供文字内容】

我不会深入讲解卡尔曼滤波的数学公式，因为我想讨论其问题并转向更复杂的方法。我对卡尔曼滤波器的三个主要问题：

1.  只能表达线性状态函数的演变

1.  通过状态和观测噪声协方差矩阵难以校准拟合度

1.  在意外噪声下可能变得数值不稳定（概率降至 0 或可能剧烈振荡）

**扩展卡尔曼滤波器**部分解决了这些问题之一（非线性状态函数的问题），通过调整卡尔曼分布估计来使用状态和观测函数的 1 或 2 项泰勒级数展开。这对于完全由一阶和二阶导数描述的函数来说效果很好，尽管在标定和稳定性方面有类似的缺点。

除非使用计算成本高昂的**粒子滤波器**，否则似乎**无迹卡尔曼滤波器**（UKF）是我将使用的潜在状态系统中的最佳选择。使用确定性采样方法通过非线性函数映射的 UKF，为潜在分布提供了多个矩。这比 EKF 的泰勒展开能提供更精确的分布描述。

**讨论主题**：

1.  无迹变换

1.  平滑处理

1.  需要采用多模型方法，并伴有马尔可夫切换

1.  多模型滤波方法

1.  可能的模型
