<!--yml

类别：未分类

日期：2024-05-18 15:32:34

-->

# 转移熵 | Tr8dr

> 来源：[`tr8dr.wordpress.com/2010/08/29/transfer-entropy/#0001-01-01`](https://tr8dr.wordpress.com/2010/08/29/transfer-entropy/#0001-01-01)

我正在重新研究表达资产之间关系的生成树和聚类。我还对一个相关问题感兴趣：在高维资产回报分布中降低维度。

![](https://tr8dr.wordpress.com/wp-content/uploads/2010/08/screen-shot-2010-08-30-at-12-56-59-pm.png)

**线性方法** 最朴素的方法是查看时间序列之间的相关性。相关性在此目的上有几个众所周知的问题：

1.  相关性≠因果性

1.  相关性可以在任意样本期间完全无关的变量之间发生

1.  相关性是相似性的线性度量

VECM 模型在识别因果性方面比相关性方法有显著改进。对于不熟悉 VECM 的人来说，它与 ARMA 模型相似，但扩展到包括其他时间序列的滞后项。对于两个变量，一个滞后 p 的 VECM 将设置为：

![](https://tr8dr.wordpress.com/wp-content/uploads/2010/08/screen-shot-2010-08-29-at-2-29-29-pm.png)

即Δx 是用滞后Δx'和滞后Δy'来描述的。解决这个问题（通常以矩阵形式），可以得到系数（假设具有统计显著性），平均来说描述了系列 X 和 Y 之间的相互作用。

进一步来说，可以进行“格兰杰因果性检验”，进行 F 检验以确定带有交叉滞后项的Δx 是否比没有交叉滞后项的Δx 产生显著更小的误差方差。为此，对各种滞后期进行检验，以确定存在“因果性”（或根本不存在）的最小滞后数量。

这对于正态分布的回报来说不是个坏方法，但是对于具有非线性特征的数据来说是有缺陷的。

**信息论** 结果表明，信息论在分析因果性（或至少是从一个市场到另一个市场的信息时间流动）方面提供了强大的工具。

香农将特定事件“e”的信息测量为：

![](https://tr8dr.wordpress.com/wp-content/uploads/2010/08/screen-shot-2010-08-29-at-2-56-56-pm.png)

让我们用一个符号来表示系统中的每个可能的独特事件{A, B, C, … }。时间上对这些事件的抽样将导致一系列符号（例如：ABAAABBBBABABAA）。如果符号 B 以 p(B)=1（即 BBBBBBBB），则序列无法携带任何信息，因为它只能表示 1 个状态。注意在这种情况下，I(B)将是 0。

香农进而将系统的熵定义为期望信息含量：

![屏幕快照 2010-08-29 下午 3.44.54](https://tr8dr.wordpress.com/wp-content/uploads/2010/08/screen-shot-2010-08-29-at-3-44-54-pm.png)

这可以扩展到查看两个或更多“符号”生成器的联合熵，例如：

![屏幕快照 2010-08-29 下午 3.49.31](https://tr8dr.wordpress.com/wp-content/uploads/2010/08/screen-shot-2010-08-29-at-3-49-31-pm.png)

观察到如果 X 和 Y 是独立的，p(x,y) = p(x)p(y)，我们可以确定与两个序列独立相比，在联合事件空间中引入了多少信息：

![屏幕快照 2010-08-29 下午 4.02.49](https://tr8dr.wordpress.com/wp-content/uploads/2010/08/screen-shot-2010-08-29-at-4-02-49-pm.png)

上述称为“互信息”度量。这个度量没有区分信息 X 向 Y 提供还是 Y 向 X 提供。在金融领域，了解信息的流向方向比它们仅仅共享信息更有用。

**转移熵**

转移熵是比互信息更精确的度量，因为它捕捉了信息流向方向和时间关系。转移熵方法与格兰杰因果关系几乎成比例，区别在于它适用于更广泛的系统（因为格兰杰因果关系和转移熵已证明对于具有正态分布噪声的数据是等价的）。

与格兰杰因果关系（GC）类似，我们比较了有和没有另一系列解释变量的熵（或在 GC 的情况下：误差方差）。对于单个滞后，这导致以下度量：

![屏幕快照 2010-08-29 下午 4.21.53](https://tr8dr.wordpress.com/wp-content/uploads/2010/08/screen-shot-2010-08-29-at-4-21-53-pm.png)

上述表达了 y[t] 对 x[t+1] 的转移熵，即 y[t] 对 x[t+1] 有多大的影响。改变条件概率来表达 p(y[t+1] | x[t], y[t]) 会使我们能够探索另一个方向。当然，这可以针对更多滞后进行评估（上述仅为 1 个滞后）。

最后，需要考虑给定的转移能量的显著性水平，以了解在观察过去滞后或其他变量时，是否存在进一步的关系。采用的方法是在打乱的序列中测量基线熵（一种移除相关性但保持符号和边际频率的方法）。

如果数据集中存在非线性关系，这种方法比格兰杰方法更加健壮。
