<!--yml

分类：未分类

日期：2024-05-12 18:56:12

-->

# 量化交易：更多数据还是更少预测变量：哪种是过拟合的更好治疗方法？

> 来源：[`epchan.blogspot.com/2017/03/more-data-or-fewer-predictors-which-is.html#0001-01-01`](http://epchan.blogspot.com/2017/03/more-data-or-fewer-predictors-which-is.html#0001-01-01)

构建交易模型中的一个长期问题数据稀疏性和随之而来的过拟合危险。幸运的是，有针对这两个问题的系统方法。这些方法在机器学习中被广泛知道，尽管大多数传统的机器学习应用比我们交易员习惯的数据要多得多。（例如，谷歌用了 1000 万 YouTube 视频来训练一个深度学习网络去

识别猫的面部：[链接](http://static.googleusercontent.com/media/research.google.com/en//archive/unsupervised_icml2012.pdf)

。）

为了从空气中创造更多的训练数据，我们可以

*重采样*

（或许更生动地，

对我们的现有数据进行*过采样*。 这称为装袋。让我们用我在

中描述的基本面因子模型来说明这一点。

新书：[链接](http://amzn.to/2kTMvUM)

。它使用了 27 个因子载荷，如 P/E，P/B，资产周转等每只股票。 （请注意，我称跨截面因子，即依赖于每只股票的因子为“因子载荷”，而不是“因子”，这是一种惯例。）这些因子载荷来自标普 500 公司的季度财务报表，可以从 Sharadar 的核心美国基本面数据库（以及更昂贵的来源如 Compustat）获得。因子模型非常简单：它只是一个多元线性回归模型，下一季度的股票回报作为依赖（目标）变量，27 个因子载荷作为独立（预测器）变量。训练包括找到这些 27 个预测器的回归系数。基于这个预测因子模型的交易策略同样简单：如果预测的下一季度回报为正，买入股票并持有一个季度。反之亦然用于空头。

注意已经采取了一个步骤来治疗数据稀疏性：我们并没有尝试为每只股票建立一个不同的回归系数模型。我们限制模型，使得相同的回归系数适用于所有股票。否则，我们从 200701-201112 使用到的训练数据将只有 1,260 行，而不是 1,260 x 500 = 630,000 行。

这个基线交易模型的结果并不坏：在 201201-201401 的外部样本期间，它的年复合增长率为 14.7%，夏普比率为 1.8。（警告：这个投资组合不一定与市场或美元中性。因此，回报可能是因为在测试期间享受牛市的长期偏见。感兴趣的读者当然可以测试这个策略的市场中性版本，用 SPY 进行对冲。）我在下面画了股票曲线。

接下来，我们通过随机选择 N（=630,000）个数据点来重采样数据

*带替换*

形成一个新的训练集（一个“袋子”），我们重复这个 K（=100）次来形成 K 个袋子。对于每个袋子，我们训练一个新的回归模型。最后，我们平均这些 K 个模型的预测回报，作为我们的官方预测回报。这使得年化复合增长率（CAGR）提高了 15.1%，而夏普比率没有变化。

现在，我们尝试减少预测变量集。我们使用一种叫做“随机子空间”的方法。我们随机选取原始预测变量的一半来训练一个模型，重复这个 K=100 次。再次，我们平均所有这些模型的预测回报。与装袋方法结合，这使得年化复合增长率（CAGR）进一步提高到 15.1%，夏普比率几乎没有变化。

两种方法的效果可能看起来不大，但至少它显示原始模型对随机化是稳健的。

但还有一种减少预测变量的方法。它叫做逐步回归。这个想法很简单：我们一次从原始集合中选取一个预测变量，只有当贝叶斯信息准则（BIC）降低时，我们才将其加入到模型中。BIC 基本上是基于回归模型的训练数据的负对数似然，还有一个与预测变量数量成比例的惩罚项。也就是说，如果两个模型的对数似然相同，参数数量更多的模型会有更大的 BIC 从而受到惩罚。一旦我们达到最小 BIC，我们然后尝试一次从模型中移除一个预测变量，直到 BIC 不再降低。将这个方法应用于我们的基本因子载荷，相比于基础模型，我们取得了相当显著的年化复合增长率提升：19.1%对比 14.7%，而夏普比率保持不变。

令人满意的是，逐步回归模型只从原始的 27 个变量中选择了两个。让这个事实沉淀一会儿：仅两个变量就构成了季度财务报告的所有预测力！至于这两个变量是哪两个——我将在我的讲座中透露。

[QuantCon 2017](http://www.quantcon.com/)

于 4 月 29 日。

===

**即将到来的研讨会**

3 月 11 日和 18 日：

[用 Python 进行加密货币交易](http://epchan.com/workshops)

我将主持这场在线研讨会，我的朋友 Nick Kirk 将会教授一个类似的课程，他在伦敦的 CQF 教授过此类课程，广受好评。

5 月 13 日和 20 日：

[人工智能技术在交易中的应用](http://epchan.com/workshops)

我将详细讨论上述提到的 AI 技术，以及其他例子和课堂练习。像往常一样，我会覆盖细微之处和潜在陷阱。
