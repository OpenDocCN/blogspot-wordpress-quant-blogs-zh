<!--yml

category: 未分类

date: 2024-05-12 19:01:59

-->

# 量化交易：隐马尔可夫模型应用于外汇预测

> 来源：[`epchan.blogspot.com/2012/03/hidden-markov-model-applied-to-fx.html#0001-01-01`](http://epchan.blogspot.com/2012/03/hidden-markov-model-applied-to-fx.html#0001-01-01)

我有兴趣地阅读了圣路易斯联邦储备银行 Dueker 和 Neely 发表的较早论文"

[Can Markov Switching Models Predict Excess Foreign Exchange Returns?](http://research.stlouisfed.org/wp/2001/2001-021.pdf)

"。我喜欢隐马尔可夫模型，因为它在语音识别应用中取得了巨大的成功，但我承认我从未能够创建出一个在外汇预测中超越简单技术指标的 HMM 模型。我将这一点归咎于自己缺乏创造力，以及 HMM 往往有太多需要通过历史数据进行拟合的参数，这使得它容易受到数据窥探偏差的影响。因此，我带着很大的希望阅读了这篇论文，希望专家们能教我如何正确地将 HMM 应用于金融。

模型的目标很简单：预测汇率在 8 天内的超额回报。（在此上下文中，超额回报通过汇率的变化百分比减去基础货币和计价货币之间的利率差异来衡量。）如果预期的超额回报高于一个阈值（在论文中称为“过滤器”），那么做多。如果它低于另一个阈值，那么做空。尽管预测是在 8 天的回报上，但交易决策是每天做出的。

超额回报假定为具有 3 个参数的学生 t 分布。这三个参数是均值、自由度和规模。规模参数（控制方差）可以根据马尔可夫模型在高水平和低水平之间切换。自由度（控制峰度，也称为“尾巴的厚度”）也可以根据另一个马尔可夫模型在两个值之间切换。均值与自由度、规模假设的值以及另一个在两个值之间切换的马尔可夫变量线性相关。因此，均值可以假设 8 个不同的值。这三个马尔可夫模型是独立的。学生 t 分布比正态分布更适合于建模金融回报，因为它允许有重尾。作者还认为，这个模型捕捉了高波动性和低波动性时期的切换，以及由此导致的对“安全”和“风险”货币的偏好变化（=不同的均值回报），这一现象在 2011 年 8 月至 2012 年 1 月期间得到了很好的证明。

为了最小化超额回报的累计偏差，每个货币对在样本内期间（1974-1981）对马尔可夫模型和学生-t 分布的参数进行估计。总共有 14 个参数需要这样估计。在这些估计之后，我们还需要通过最大化交易策略在样本内的回报来估计 2 个交易阈值，假设每笔交易的交易成本为 10 个基点。

拥有如此多的参数（总共 16 个）让我不敢想象样本外的结果（1982-2005）。惊人的是，这些结果比我预期的要好得多：对于 4 大货币对的年度回报率介于 1.1%至 7.5%之间。夏普比率并不那么令人印象深刻：介于 0.11 至 0.71 之间。当然，当研究者报告样本外结果时，你应该对此持保留态度。如果样本外结果不好，他们就不会报告，而是会持续更改底层模型直到获得好的“样本外”结果！所以真正使用这个模型、将其应用于 2005 年后的数据以及更多的货币对，以找出这里是否真的有什么东西，取决于我们。事实上，这就是我为什么更愿意阅读较旧的论文的原因——为了允许真正的样本外测试立即进行。

你认为有哪些方法可以改进这个模型？我怀疑作为第一步，可以看看估计的马尔可夫状态是否与交易者认为的风险偏好（risk-on）与风险规避（risk-off）体制相符。如果相符，那么无论这个模型作为信号生成器的使用如何，它至少能生成良好的

[风险指标](http://epchan.blogspot.com/2011/12/risk-indicators.html)

如果不然，那么或许需要用一个基于可观测指标的条件马尔可夫模型来替代隐藏的马尔可夫模型。
