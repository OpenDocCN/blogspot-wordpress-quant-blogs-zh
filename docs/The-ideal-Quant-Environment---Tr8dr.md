```

分类：未分类

日期：2024-05-18 15:34:27

```

# 理想量化环境 | Tr8dr

> 来源：[`tr8dr.wordpress.com/2010/01/27/the-ideal-quant-environment/#0001-01-01`](https://tr8dr.wordpress.com/2010/01/27/the-ideal-quant-environment/#0001-01-01)

R 是一个很好的工具，因为可以用它快速地进行原型设计和测试想法。  如果你不用 R，而把大部分工作都用到 C++或其他低级语言，你会错过很多东西。  C++ / Java / C#与 R 之间的发展速度是 10-50 倍。

R 作为一门语言和环境，确实有很多瑕疵。  我对其矩阵、索引运算符或懒表达式解析不太感冒。更糟糕的是，R 对大数据集的处理速度慢且内存管理存在问题。  我估计 R 的速度是 java 或 C++的 1/100，具体取决于你在做什么。

我目前的环境是 R 和几种低级语言的组合。对于我大部分的后探索工作，我感到有必要用低级语言编写，因为 R 的性能问题。我的偏好是使用函数式语言，因为它们通常非常简洁优雅。

**理想环境**

以下是我理想环境的描述：

1.  广度和深度都类似于 R

1.  干净的功能语言设计

1.  简洁的操作（尽可能接近数学）

1.  优秀的渲染设施

1.  实时性能

1.  能够处理大数据集（内存高效）

1.  并发性（我进行很多并行评估）

**候选人**

以下是我使用或探索过的候选环境：

1.  python

    更简洁，通常比 R 快，统计方面几乎没有，与 R 的集成也很差。真正的并发性因为解释器锁定而不存在。

1.  Ocaml

    语言简洁优雅，INRIA 实现不支持并发

1.  F#的 Ocaml 变体

    解决了 Ocaml 的问题，但受限于 MS 平台

1.  Scala

    卓越性能，稍微前沿一些，比 Ocaml 复杂得多，但在 JVM 上。

**特制混合**

考虑重新实现 R 的一个子集到另一个语言环境是不切实际的。混合方法是有意义的。使用 python，你有**Rpy**，使用 Java 有**JRI**。这些都没有与语言的第一类交互。

我希望拥有生产功能语言的威力，同时拥有 R 相同的开发人机工程和交互。   我想到可以这样做：

1.  把所有 R 环境中的函数模板 dump 到一个 Scala 模块

1.  为我 Scala 对象（矩阵、向量、数据框等）创建隐式转换函数，从 R 基本类型

1.  为我 Scala 侧的时间序列和 R 动物园/ts 对象之间创建专门的映射

1.  为不寻常的使用模式（如 ggplot 运算符）创建一些包装

Scala 有一个交互式模式，其中函数、类等可以即兴创建。由于我们已经为每个 R 函数放弃了代理函数，我们也可以接近一等公民地访问 R 函数。存在一些差异，例如无法复制某些 R 函数的懒评价方面。使用 expression()的函数必须特殊包装。

由于 Scala 允许大量的语法魔法，环境将看起来非常像 R，并拥有对 R 的完全访问权限，但拥有更强大的 Scala 的巨大优势。人们可以编写“生产就绪”的代码从一开始，或者执行在 R 中 otherwise 禁止的非常计算密集型的操作。

现在我需要找到时间来整合这一切...

**补充**

我还没有决定基于哪种语言/环境。Scala 的主要卖点是它运行在 JVM 上。JVM 上的另一种功能性语言竞争对手，具有超越脚本级别的性能的是 Clojure。

Clojure 基本上是 Lisp 的一种方言，并且已经有一个名为[Incanter](http://github.com/liebke/incanter#readme)的项目，在 Clojure 中提供了一个统计环境。它看起来很有趣，尽管还处于早期阶段。Clojure 还没有一个接近硬件的性能配置文件。我预计会随着时间的推移看到改进，但由于 Lisp 缺乏静态类型或类型推断，我不太相信我们会看到 Clojure 达到静态类型语言的水平。

自从写了这篇文章并与他人交流之后，我开始认为 F#可能是最佳选择。我的语言偏好一直是使用 Ocaml，但 INRIA 的 Ocaml 实现存在缺陷。F#与 Ocaml 关系密切，因此可能是一个合适的选择。

F#在 MS .NET 平台上的性能已经被证明与 C#相当。从几年前对 C#的基准测试来看，很明显 CLR 在性能上与 JVM 相当接近。考虑到我的跨平台限制，F#与 Mono 从性能角度来看是否可行一直是个问题？

似乎 Mono 的性能正在得到解决。Mono LLVM 实验显著提高了 mono 基准测试。我没有能够测试带有此扩展的 Mono。将进行实验。

要将这个与 R 结合，需要编写相当于 JRI 的.NET/R 等效物。
