<!--yml

分类：未分类

date: 2024-05-18 05:24:22

-->

# Magmasystems Blog: 活配置文件之夜

> 来源：[`magmasystems.blogspot.com/2005/10/night-of-living-config-files.html#0001-01-01`](http://magmasystems.blogspot.com/2005/10/night-of-living-config-files.html#0001-01-01)

我的同事

[Pinakin](http://pinakin-uk.blogspot.com)

今天在他的项目中写了关于配置文件地狱的博客。

这让我忍俊不禁。我们在上一个项目中经历了完全相同的事情。我们系统的一部分被迫使用一个由外部咨询公司为我的客户，一家大型金融机构构建的框架。这个框架使用服务定位器模式来管理服务。每个服务都有它自己的基于 XML 的配置文件，里面包含了所有各种 DLL 的绝对路径。这家外部公司还有一个坏习惯，就是在框架的每次重大发布时更改各种程序集的命名空间。不言而喻，每次框架的重大发布都会给我们带来一些麻烦，因为我们急于找到所有不再加载的各种程序集。

我们看到了这个外部框架实现中的一些错误。如果你正在编写使用服务定位器模式的服务，有一些事情你需要注意。

1) 顺序。如果服务之间有依赖关系，某些服务必须在其他服务之前加载。例如，如果你有一个日志服务，如果无法创建日志文件，这个日志服务将使用异常处理服务，那么异常处理服务必须先加载。这个框架犯的一个错误是将所有服务代理配置信息读取到一个哈希表中，然后遍历哈希表以实例化每个服务。嗯，哈希表是以伪随机方式遍历的，所以当你实例化每个服务时，你肯定会遇到顺序问题。

2) 默认行为。如果一个“非关键”服务无法加载，你是否终止程序？例如，如果日志服务无法加载，只需关闭日志（除非由于审计规则，日志必须始终可用）。如果某个服务无法加载，做一些合理的事情。不要只返回一个神秘的错误信息。我花在追踪 Assembly.Load()错误上的时间比我愿意想象的时间还要多。
