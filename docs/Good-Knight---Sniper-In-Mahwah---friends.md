注释

category: 未分类

date: 2024-05-18 14:25:13

---------

# 良好的骑士 - 马瓦和朋友

> 来源：[`sniperinmahwah.wordpress.com/2013/11/02/good-knight/#0001-01-01`](https://sniperinmahwah.wordpress.com/2013/11/02/good-knight/#0001-01-01)

与这个博客的沉默相反，我们已经很久以前就结束了假期——在同时撰写有关高频交易等（有时）棘手主题的博客的情况下撰写一本书是非常复杂和耗时的。为了庆祝我们的数字回归，这里是关于[判决](http://www.sec.gov/litigation/admin/2013/34-70694.pdf) Knight 资本因 2012 年 8 月 1 日市场做市商断路事件导致在 40 分钟内损失 4.61 亿美元而被 SEC 处罚 1200 万美元的简要报告。这一事件在当时引起了很大的轰动，Knight 被处罚的原因尤其有趣，因为它既完全与高频交易有关...又完全不是。

**零售流动性计划（纽交所）**

2012 年 8 月 1 日，纽约证券交易所启动了一个名为零售流动性计划（RPL）的新计划。根据纽交所的一位负责人的说法，RPL 经过与 SEC 两年的激烈讨论，其目标是允许个人获得比纽交所平台中心订单簿中所显示的更好的报价/交易价格。与美国 13 个交易平台（Nyse 或 Nyse-Arca）的讨论持续了两年，这是因为该计划颇具争议性：通过提供与“明智市场”（美国的 13 个交易平台）不同的价格，这个面向个人而非做市商的计划自始至终都受到了批评，因为它与“暗池”（美国约 50 个交易平台）极为相似，这些“暗池”指的是一系列完全匿名的交易平台和非公开的价格 — 这些暗池可以是高盛的 Sigma-X 或瑞士信贷的 Crossfinder 等交易平台，也可以是内部化者，即银行或做市商内部的交易平台，他们在内部匹配客户订单而不是将其路由到美国 13 个明智市场...或其他暗池。

让我们暂且不谈每天都愈发争议的“暗池”——越来越多的交易发生在这些暗池中，这既令监管机构担忧……也令开放市场担忧，因为暗池是传统市场的直接竞争者，导致它们的流量下降——，只需明确指出 NYSE 的 CEO 邓肯·尼德罗在暗池对手上表现得相当激烈 ，这点不乏反对“零售流动性计划”的人揭示。通过批准 RLP，SEC 允许了所谓的*亚分规则*（纳入 Reg NMS）的例外规定，该规则禁止证券交易场所接受超过或低于当前报价 1 美元以上或以下 1 美分的订单。在具体上 ，一支报价为 20.50 美元的股票只能交易在 19.50 美元至 21.50 美元之间*最低*，或 20.49 美元至 20.51 美元*最高*。因此，Reg NMS 禁止*一美分*以下的步进。通过 SEC 允许的这个例外，NYSE 的 RLP 被授权将步进改为 1 美分，从而提高了价格——20.50 美元的股票可以以 20.4999 或 20.5001 美元买入或卖出，这个范围比交易平台“标准”的订单簿更精确。

这种价格的“数字化”（或*离散*应该在科学意义上理解）是一个广泛的话题，如果将其置于金融市场机器到达的历史之中（我们远离 20 世纪 90 年代，股价步进为 1/8 美元的时代：对于报价为 20.50 美元的股票，无法做出 20.25 至 20.50 美元之间，或 20.50 至 20.75 美元之间的报价）。根据 NYSE 的说法，*零售流动性计划*平均应该能提供 1.4 美分的改善价格，适用于直接在 NYSE 和 NYSE-Arca 平台上下订单的个人投资者。该计划于 2012 年 6 月获得 SEC 的批准，计划于 2012 年 8 月 1 日启动，这给定单方面交易者一些时间来更新他们与这些平台的连接（自那时起，纳斯达克和 Bats 也得到了克服*亚分规则*的许可）。

**路由和信息**

根据 SEC 关于那天“Knightmare”事件的相当惊人的报告，华尔街最强大的*市场制造商*之一的崩溃是一系列疏忽监管的结果，报告中给出了一些有趣的细节。简而言之：

– 为了能够顺利连接 RLP，Knight Capital 必须更新 SMARS，这是一款超快速路由器，用于向市场发送订单。具体来说，SMARS 将来自 Knight 的“父”订单分派到一个或多个交易平台上执行的“子”订单。这个新的路由算法代码应该取代一个名为“Power Peg”的功能，Knight 自 2003 年以来就不再使用，但其代码仍然嵌入在路由器中（第一个问题）。Power Peg 的作用是传递有关子订单的信息：如果这些订单在某个交易平台上进行了交易，那么（简而言之）父订单就会被告知，并从要执行的订单列表中删除这些子订单。没有什么复杂的。

– 2012 年 7 月 27 日，Knight 开始在其测试路由器上部署新的 RLP 路由算法……但是根据证监会称，“在部署新代码的过程中，一名技术人员没有在 SMARS 的八台服务器之一上复制新代码”。*人非圣贤，孰能无过*。更令人印象深刻的是，Knight Capital 并没有为这个新代码的实施设计任何控制手段。因此，一个 SMARS 服务器保存了其旧代码……而这段代码已经被“转移到”到执行的常规代码中的另一个地方（第二个问题）。

– 2012 年 8 月 1 日：SMARS 连接到 RLP，同时接收来自 Knight 客户的订单。具有新路由代码的七台服务器完美运行……但第八台却未能如此，它重新激活（事实上）了 Power Peg，这是旧的路由代码，不仅对 RLP 来说已经过时，而且由于其移动而执行起来非常危险。 结果（为了简洁起见）：第七台服务器没有将有关子订单是否执行的信息传送回来，因此父订单看起来就像从未执行过一样。这些订单因此全部被循环发送回市场，无论它们是否已被执行。哎呀。

– 具体来说：212 个母订单导致了… 数百万的子订单，产生了对 154 种不同股票的 400 万笔交易，在 45 分钟内- 真是既壮丽又令人咋舌。然后我们会发现，相对于……Knight 在事件结束前几分钟所持有的 65.5 亿美元的仓位（显然是非自愿的），4.61 亿美元的亏损已经不算什么了。此外，如果 SEC 的说法准确的话，会惊讶地发现，在市场开张的 08:01 到 09:30 之间（也就是市场开头一个半小时内），就有 97 封警告邮件（主题是“ *Power Peg disabled*”）发送给 Knight 的某些员工，而这些邮件都没有得到回应 - 1）这些人要么是在睡觉，2）要么试图但没有成功地解决问题，却不得不启动与 NYSE 的 *零售流动性计划* 的连接。所有这些过失都在 SEC 的报告中详细描述和受到制裁。

*Errare humanum est, perseverare diabolique* : « 错误是人性的，坚持错误则是邪恶的 » 如谚语所说… 然而，这正是 Knight 某一时刻所做的事情（这则故事最令人震惊的地方）：试图解决这场混乱时，Knight 决定关闭了那正常运行的 7 台服务器的新路由代码，而 Power Peg，那个现在已经失效的旧代码，接管了指令，让 Knight 陷入麻烦中（这大概就是公司账户出现了数十亿美元亏损的时候）。除了技术细节，故事的教训就是：一个运营商的单一服务器上一个单一路由算法的人为错误，都可能对市场上的 75 种股票报价产生影响，其中 37 种报价波动超过 10%。在机器快速高效地工作的世界，一个小小的人为错误就足以引发灾难。

**胜者为王… 高盛**

有些人认为 SEC 的裁决是“可耻的”：亏损了 4.61 亿美元已经足够，无需再加上罚款。此外，一些订单本来可以被市场直接取消，特别是由 NYSE（考虑到事件规模，完全取消可能会很复杂）来进行，以弥补 Knight 遭遇的重大失败。在 Goldman Sachs 迅速救助之后，高频交易市场中的重要公司 Getco 收购了 Knight（对于 Getco 而言这是意料之外的捷利，自 2012 年底以来的高频交易业务利润已经缩水了 80%，但是他们获得了一个有效的 *市场创造者*，尽管出现了人为的 *错误*）。

在 2013 年 8 月 20 日，纳斯达克因技术问题被迫完全关闭后不久，高盛也出现了一次*故障*（不是*错误* ;)），
