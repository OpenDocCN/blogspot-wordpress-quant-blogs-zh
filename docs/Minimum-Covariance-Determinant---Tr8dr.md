<!--yml

分类：未分类

日期：2024-05-18 15:31:05

-->

# 最小协方差行列式| Tr8dr

> 来源：[`tr8dr.wordpress.com/2010/09/24/minimum-covariance-determination/#0001-01-01`](https://tr8dr.wordpress.com/2010/09/24/minimum-covariance-determination/#0001-01-01)

异常值在噪声数据中非常常见。不幸的是，异常值可能会偏估矩估计。在这种情况下，我感兴趣的是数据集的协方差。除了在随机方程中占主导地位，在金融中的典型内容（投资组合分析），它还用于线性投影和预测。

在几何上，协方差矩阵指定了一个包围 N 空间（N 为数据维度）主要维度的椭圆。异常数据沿着与平均值相对的异常轴拉伸椭圆。以下是 Hubert 和 Verboven 论文中说明这一点的图表：

![](https://tr8dr.wordpress.com/wp-content/uploads/2010/09/screen-shot-2010-09-24-at-6-23-30-pm.png)

对于许多应用，我们对“稳健”协方差感兴趣，如图中较小椭圆所示。

**说明性暴力算法

我们想要找到一个协方差矩阵，它所包含的体积最小，并能覆盖数据集的某些%。让我们假设我们有一组观测值 X = {x1, x2, … xN}，大小为 N。进一步假设 10%的样本是异常值。一个人可以构建一个暴力算法如下：**

1.  确定所有独特的大小为**h = 0.9N**的样本子集

1.  对于每个子集 S

    1.  计算 Cs = S 的协方差矩阵

    1.  计算 Vs = det(Cs)

1.  选择 Vs 最小的子集

在几何上，行列式是协方差矩阵所暗示的 N 维向量空间的体积。最小化椭圆等同于最小化体积。

**一个更好的算法

暴力算法非常低效（或无法计算），因为必须评估越来越多可能的子集的数量。** Rousseeuw 开发了一种名为 FAST-MCD 的算法。

假设我们取一个大小为**h**的随机样本。我们可以评估全集中数据点与我们随机抽样子集之间的相似性。特别是，使用马氏距离。让**M**是随机子集的平均值，**S**是随机子集的标准协方差：

![](https://tr8dr.wordpress.com/wp-content/uploads/2010/09/screen-shot-2010-09-24-at-7-44-22-pm.png)

算法如下：

1.  选择 X 中 H0 的一个随机子集，大小为 h

1.  重复

    1.  确定子集 H0 的协方差 S 和平均值 M

    1.  确定所有 Xi 相对于 H 的相对马氏距离 d(Xi)

    1.  选择 h 最小的距离，创建一个新的子集 H1

    1.  重复 Ho <- H1，直到 Ho 和 H1 相等或为 0

1.  从 1 开始评估 K 次（也许 500 次）并确定具有最小体积的选择。

随机抽样之所以有效，是因为可以证明在迭代过程中，|H1| ≤ |H0|（即我们是在迭代地减小体积），并且集合自我选择点集的最紧凑代表体积。

可以根据体积在第二次或第三次迭代时缩短随机样本的重新评估，然后对更小的随机集合进行完全评估。

对于非常大的 N，还可以使用其他技巧将问题细分。

**结果

我今天早上实现了这个算法。运行得很好。下面是一个二维正态分布数据带有异常值（红色表示被选为鲁棒协方差的优化点）的例子:**

![屏幕截图 2010-09-25](https://tr8dr.wordpress.com/wp-content/uploads/2010/09/screen-shot-2010-09-25-at-12-11-43-pm.png)
